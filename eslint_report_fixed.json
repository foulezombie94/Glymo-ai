[{"filePath":"C:\\Users\\pc\\.gemini\\antigravity\\scratch\\ai-calorie-app\\src\\App.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\pc\\.gemini\\antigravity\\scratch\\ai-calorie-app\\src\\components\\BmiWidget.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\pc\\.gemini\\antigravity\\scratch\\ai-calorie-app\\src\\context\\LanguageContext.jsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":5,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":5,"endColumn":25},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\n  11 |     const savedLang = localStorage.getItem('app_lang');\n  12 |     if (savedLang) {\n> 13 |       setLang(savedLang);\n     |       ^^^^^^^ Avoid calling setState() directly within an effect\n  14 |     }\n  15 |   }, []);\n  16 |","line":13,"column":7,"nodeType":null,"endLine":13,"endColumn":14}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { createContext, useContext, useState, useEffect } from 'react';\r\n\r\nconst LanguageContext = createContext();\r\n\r\nexport const useLanguage = () => useContext(LanguageContext);\r\n\r\nexport const LanguageProvider = ({ children }) => {\r\n  const [lang, setLang] = useState('EN');\r\n\r\n  useEffect(() => {\r\n    const savedLang = localStorage.getItem('app_lang');\r\n    if (savedLang) {\r\n      setLang(savedLang);\r\n    }\r\n  }, []);\r\n\r\n  const changeLanguage = (newLang) => {\r\n    setLang(newLang);\r\n    localStorage.setItem('app_lang', newLang);\r\n  };\r\n\r\n  const toggleLanguage = () => {\r\n    const langs = ['EN', 'FR', 'ES'];\r\n    const currentIndex = langs.indexOf(lang);\r\n    changeLanguage(langs[(currentIndex + 1) % langs.length]);\r\n  };\r\n\r\n  return (\r\n    <LanguageContext.Provider value={{ lang, changeLanguage, toggleLanguage }}>\r\n      {children}\r\n    </LanguageContext.Provider>\r\n  );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\pc\\.gemini\\antigravity\\scratch\\ai-calorie-app\\src\\context\\MealContext.jsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":7,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":7,"endColumn":22}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { createContext, useContext, useState, useEffect } from 'react';\r\nimport { supabase } from '../lib/supabase';\r\nimport { startOfDay, endOfDay, subDays, startOfWeek, format, isSameDay } from 'date-fns';\r\n\r\nconst MealContext = createContext();\r\n\r\nexport const useMeals = () => {\r\n  return useContext(MealContext);\r\n};\r\n\r\nexport const MealProvider = ({ children }) => {\r\n  const [meals, setMeals] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  // Sync with Supabase\r\n  useEffect(() => {\r\n    fetchMealsFromSupabase();\r\n  }, []);\r\n\r\n  const fetchMealsFromSupabase = async () => {\r\n    setLoading(true);\r\n    try {\r\n      // Get today's start and end to only fetch today's meals (or you can fetch all and filter client-side)\r\n      // For this app, let's fetch recent meals to show in history\r\n      const { data, error } = await supabase\r\n        .from('meals')\r\n        .select('*')\r\n        .order('created_at', { ascending: false })\r\n        .limit(200); // Fetch more for weekly stats\r\n        \r\n      if (error) {\r\n        // If the table doesn't exist, we'll silently fallback to local storage\r\n        if (error.code === '42P01') {\r\n          console.warn(\"Table 'meals' does not exist yet. Relying on local storage.\");\r\n        } else {\r\n          console.error('Error fetching meals:', error);\r\n        }\r\n      } else if (data) {\r\n        // Map db fields to UI expectations\r\n        const mappedData = data.map(m => ({\r\n          ...m,\r\n          ingredients: m.raw_ingredients_text || m.ingredients\r\n        }));\r\n        setMeals(mappedData);\r\n      }\r\n    } catch (err) {\r\n      console.error('Unexpected error fetching from Supabase:', err);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const addMeal = async (mealData) => {\r\n    // Generate a temporary ID for optimistic UI update\r\n    const tempId = Date.now().toString();\r\n    const newMeal = {\r\n      id: tempId,\r\n      ...mealData,\r\n      ingredients: mealData.raw_ingredients_text || mealData.ingredients,\r\n      created_at: new Date().toISOString()\r\n    };\r\n    \r\n    // 1. Optimistic Update (Immediate Feedback)\r\n    setMeals(prev => [newMeal, ...prev]);\r\n\r\n    // 2. Persist to Supabase\r\n    try {\r\n      const { data, error } = await supabase\r\n        .from('meals')\r\n        .insert([{\r\n          name: mealData.name,\r\n          calories: mealData.calories,\r\n          protein: mealData.protein,\r\n          carbs: mealData.carbs,\r\n          fats: mealData.fats,\r\n          raw_ingredients_text: mealData.raw_ingredients_text || mealData.ingredients,\r\n          image_url: mealData.image_url\r\n        }])\r\n        .select();\r\n\r\n      if (error) {\r\n        if (error.code !== '42P01') { // Ignore \"relation does not exist\" if DB not fully setup\r\n          console.error(\"Failed to add meal to Supabase:\", error);\r\n        }\r\n      } else if (data && data.length > 0) {\r\n        const insertedMeal = data[0];\r\n        // Replace temporary ID with real Supabase ID\r\n        setMeals(prev => prev.map(m => m.id === tempId ? {\r\n          ...insertedMeal,\r\n          ingredients: insertedMeal.raw_ingredients_text\r\n        } : m));\r\n\r\n        // 3. Save linked ingredients if available\r\n        if (mealData.ingredientsList && mealData.ingredientsList.length > 0) {\r\n          const ingredientsToInsert = mealData.ingredientsList.map(ing => ({\r\n            meal_id: insertedMeal.id,\r\n            name: ing.name,\r\n            weight_g: ing.weight_g,\r\n            calories: ing.calories,\r\n            protein: ing.protein,\r\n            carbs: ing.carbs,\r\n            fats: ing.fats,\r\n            icon: ing.icon\r\n          }));\r\n          \r\n          const { error: ingError } = await supabase\r\n            .from('ingredients')\r\n            .insert(ingredientsToInsert);\r\n            \r\n          if (ingError) {\r\n            console.error(\"Failed to add ingredients to Supabase:\", ingError);\r\n          }\r\n        }\r\n      }\r\n    } catch (err) {\r\n      console.error(\"Unexpected error saving meal:\", err);\r\n    }\r\n  };\r\n\r\n  const deleteMeal = async (mealId) => {\r\n    // 1. Optimistic Update\r\n    const previousMeals = [...meals];\r\n    setMeals(prev => prev.filter(m => m.id !== mealId));\r\n\r\n    // 2. Supprimer de Supabase\r\n    try {\r\n      const { error } = await supabase\r\n        .from('meals')\r\n        .delete()\r\n        .eq('id', mealId);\r\n        \r\n      if (error) {\r\n        if (error.code !== '42P01') {\r\n          console.error(\"Failed to delete meal in Supabase:\", error);\r\n          // Revert optimistic update only if genuine error (not missing table)\r\n          setMeals(previousMeals);\r\n        }\r\n      }\r\n    } catch (err) {\r\n      console.error(\"Unexpected error deleting meal:\", err);\r\n      setMeals(previousMeals);\r\n    }\r\n  };\r\n\r\n  // derived state for today's totals\r\n  const getTodayTotals = () => {\r\n    return getTotalsByRange('today');\r\n  };\r\n\r\n  const getTotalsByRange = (range = 'today') => {\r\n    const today = new Date();\r\n    const end = endOfDay(today).getTime();\r\n    let start;\r\n\r\n    if (range === 'today') {\r\n      start = startOfDay(today).getTime();\r\n    } else if (range === 'week') {\r\n      start = startOfDay(subDays(today, 7)).getTime();\r\n    } else if (range === 'month') {\r\n      start = startOfDay(subDays(today, 30)).getTime();\r\n    } else if (range === '3months') {\r\n      start = startOfDay(subDays(today, 90)).getTime();\r\n    }\r\n\r\n    const filteredMeals = meals.filter(meal => {\r\n      const mealTime = new Date(meal.created_at).getTime();\r\n      return mealTime >= start && mealTime <= end;\r\n    });\r\n\r\n    const totals = filteredMeals.reduce((acc, meal) => ({\r\n      calories: acc.calories + (Number(meal.calories) || 0),\r\n      protein: acc.protein + (Number(meal.protein) || 0),\r\n      carbs: acc.carbs + (Number(meal.carbs) || 0),\r\n      fats: acc.fats + (Number(meal.fats) || 0),\r\n    }), { calories: 0, protein: 0, carbs: 0, fats: 0 });\r\n\r\n    const totalMacros = totals.protein + totals.carbs + totals.fats;\r\n    \r\n    // Calculate percentages (avoid NaN)\r\n    const percentages = totalMacros > 0 ? {\r\n      protein: Math.round((totals.protein / totalMacros) * 100),\r\n      carbs: Math.round((totals.carbs / totalMacros) * 100),\r\n      fats: Math.round((totals.fats / totalMacros) * 100),\r\n    } : { protein: 0, carbs: 0, fats: 0 };\r\n\r\n    return {\r\n      totals,\r\n      percentages,\r\n      meals: filteredMeals\r\n    };\r\n  };\r\n\r\n  const getWeeklyStats = () => {\r\n    const today = new Date();\r\n    // Les 7 derniers jours (ex: du lundi au dimanche, ou juste 7 glissants)\r\n    // Le design montre MON -> SUN. On va générer les données pour la semaine courante.\r\n    const weekStart = startOfWeek(today, { weekStartsOn: 1 }); // Commence le lundi\r\n    \r\n    let totalWeeklyCalories = 0;\r\n    const weeklyData = Array.from({ length: 7 }).map((_, i) => {\r\n       const day = new Date(weekStart);\r\n       day.setDate(weekStart.getDate() + i);\r\n       \r\n       const dayMeals = meals.filter(m => isSameDay(new Date(m.created_at), day));\r\n       \r\n       const dayTotals = dayMeals.reduce((acc, meal) => ({\r\n          calories: acc.calories + (Number(meal.calories) || 0),\r\n          protein: acc.protein + (Number(meal.protein) || 0),\r\n          carbs: acc.carbs + (Number(meal.carbs) || 0),\r\n          fats: acc.fats + (Number(meal.fats) || 0)\r\n       }), { calories: 0, protein: 0, carbs: 0, fats: 0 });\r\n\r\n       totalWeeklyCalories += dayTotals.calories;\r\n\r\n       const totalMacros = dayTotals.protein + dayTotals.carbs + dayTotals.fats;\r\n       const p = totalMacros > 0 ? Math.round((dayTotals.protein / totalMacros) * 100) : 0;\r\n       const c = totalMacros > 0 ? Math.round((dayTotals.carbs / totalMacros) * 100) : 0;\r\n       const f = totalMacros > 0 ? Math.round((dayTotals.fats / totalMacros) * 100) : 0;\r\n\r\n       // Bar chart height calculation based on user goal or fallback of 2600 kcal\r\n       const maxKcal = parseInt(localStorage.getItem('user_calorie_goal')) || 2600;\r\n       const heightPercent = Math.min(100, (dayTotals.calories / maxKcal) * 100);\r\n\r\n       return {\r\n         day: format(day, 'EEE').toUpperCase(), // MON, TUE...\r\n         p, c, f, \r\n         total: heightPercent,\r\n         rawCalories: dayTotals.calories\r\n       };\r\n    });\r\n\r\n    const dailyAverage = Math.round(totalWeeklyCalories / (today.getDay() === 0 ? 7 : today.getDay()));\r\n\r\n    return {\r\n      weeklyData,\r\n      totalWeeklyCalories,\r\n      dailyAverage\r\n    };\r\n  };\r\n\r\n  const [weightLogs, setWeightLogs] = useState([]);\r\n  const [weightTrend, setWeightTrend] = useState({ diff: 0, latest: 0 });\r\n  const [waterToday, setWaterToday] = useState(0);\r\n  const [bmi, setBmi] = useState(0);\r\n\r\n  useEffect(() => {\r\n    fetchWeightLogs();\r\n    fetchWaterLogs();\r\n  }, []);\r\n\r\n  const fetchWaterLogs = async () => {\r\n    try {\r\n      const todayStart = startOfDay(new Date()).toISOString();\r\n      const { data, error } = await supabase\r\n        .from('water_logs')\r\n        .select('amount_ml')\r\n        .gte('created_at', todayStart);\r\n\r\n      if (error && error.code !== '42P01') {\r\n        console.error('Error fetching water logs', error);\r\n      } else if (data) {\r\n        const total = data.reduce((sum, log) => sum + (Number(log.amount_ml) || 0), 0);\r\n        setWaterToday(total);\r\n      }\r\n    } catch (err) {\r\n      console.error('Unexpected error fetching water', err);\r\n    }\r\n  };\r\n\r\n  const fetchWeightLogs = async () => {\r\n    try {\r\n      const { data, error } = await supabase\r\n        .from('weight_logs')\r\n        .select('*')\r\n        .order('logged_date', { ascending: false });\r\n\r\n      let currentWeight = 0;\r\n\r\n      if (error) {\r\n         if (error.code !== '42P01') console.error('Error fetching weight logs', error);\r\n      } else if (data && data.length > 0) {\r\n        setWeightLogs(data);\r\n        currentWeight = Number(data[0].weight);\r\n        \r\n        // Calculer la tendance (différence entre le dernier poids et le précédent)\r\n        if (data.length >= 2) {\r\n          const latest = Number(data[0].weight);\r\n          const previous = Number(data[1].weight);\r\n          setWeightTrend({\r\n            latest,\r\n            diff: Number((latest - previous).toFixed(1))\r\n          });\r\n        } else if (data.length === 1) {\r\n          setWeightTrend({\r\n            latest: Number(data[0].weight),\r\n            diff: 0\r\n          });\r\n        }\r\n      }\r\n      \r\n      // Fetch profile for height & weight fallback\r\n      const { data: { session } } = await supabase.auth.getSession();\r\n      if (session) {\r\n         const { data: profile } = await supabase\r\n            .from('profiles')\r\n            .select('weight, height')\r\n            .eq('id', session.user.id)\r\n            .single();\r\n         \r\n         if (profile) {\r\n             if (currentWeight === 0 && profile.weight) {\r\n                 currentWeight = Number(profile.weight);\r\n                 setWeightTrend({ latest: currentWeight, diff: 0 });\r\n             }\r\n\r\n             if (currentWeight > 0 && profile.height) {\r\n                 const heightInMeters = Number(profile.height) / 100;\r\n                 const calculatedBmi = currentWeight / (heightInMeters * heightInMeters);\r\n                 setBmi(Number(calculatedBmi.toFixed(1)));\r\n             }\r\n         }\r\n      }\r\n    } catch (err) {\r\n      console.error('Unexpected error fetching weight', err);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <MealContext.Provider value={{ meals, loading, addMeal, deleteMeal, getTodayTotals, getWeeklyStats, getTotalsByRange, weightTrend, weightLogs, waterToday, bmi }}>\r\n      {children}\r\n    </MealContext.Provider>\r\n  );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\pc\\.gemini\\antigravity\\scratch\\ai-calorie-app\\src\\lib\\supabase.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\pc\\.gemini\\antigravity\\scratch\\ai-calorie-app\\src\\main.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\pc\\.gemini\\antigravity\\scratch\\ai-calorie-app\\src\\pages\\Dashboard.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":4,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[142,149],"text":""},"desc":"Remove unused variable 'motion'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'progressPercent' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":31,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":31,"endColumn":24,"suggestions":[{"messageId":"removeVar","data":{"varName":"progressPercent"},"fix":{"range":[1316,1392],"text":""},"desc":"Remove unused variable 'progressPercent'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\r\nimport { Link } from 'react-router-dom';\r\nimport { useLocation } from 'react-router-dom';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport { useMeals } from '../context/MealContext';\r\nimport PremiumUpgrade from './PremiumUpgrade';\r\n\r\nimport BmiWidget from '../components/BmiWidget';\r\n\r\nconst pageVariants = {\r\n  initial: { opacity: 0, x: -20 },\r\n  animate: { opacity: 1, x: 0, transition: { duration: 0.3 } },\r\n  exit: { opacity: 0, x: 20, transition: { duration: 0.2 } },\r\n};\r\n\r\nexport default function Dashboard() {\r\n  const location = useLocation();\r\n  const { getTotalsByRange, deleteMeal } = useMeals();\r\n  const [timeRange, setTimeRange] = useState('today');\r\n  const { totals, percentages, meals } = getTotalsByRange(timeRange);\r\n  const [selectedMeal, setSelectedMeal] = useState(null);\r\n  \r\n  // Show premium modal if coming from onboarding or profile\r\n  const [showPremiumModal, setShowPremiumModal] = useState(\r\n    location.state?.fromOnboarding === true || location.state?.showPremium === true\r\n  );\r\n\r\n  // Valeurs calculées dynamiquement depuis le contexte\r\n  const consumedCalories = meals.reduce((total, meal) => total + (Number(meal.calories) || 0), 0);\r\n  const dailyGoal = parseInt(localStorage.getItem('user_calorie_goal')) || 2000;\r\n  const progressPercent = Math.min((consumedCalories / dailyGoal) * 100, 100);\r\n  // Helper function to safely get images or fallback\r\n  const getMealImage = (meal) => {\r\n    return meal.image_url || \"https://lh3.googleusercontent.com/aida-public/AB6AXuCZ0vh-R2bBPLbGmcfqAbmMemmpfCQHvlTt56im37k12xfL7-NVEWBqLSTS87p56zdpJi4OPJ-TJxUtGGsTj_NEHsGdzuSVqs7bbnmCu1mRFAWG7ETNBYTJV_5fi8-m72QFC9lLPmH6kZNoUH0_kKfsfCV3By_yNRk2bQZiv8Y7Er0uW1A37B3kdcTqWx671OKp_0ESuoYnM7d-ZAb7wtDiFh_qaQ-EqcbHG7WZNZmqnz_N0-EGUoU2uJOO6p9kxYMyIsXxbieKN8hN\";\r\n  };\r\n\r\n  return (\r\n    <motion.div \r\n      className=\"bg-background-light dark:bg-background-dark font-display text-slate-900 dark:text-slate-100 min-h-screen flex justify-center\"\r\n      variants={pageVariants}\r\n      initial=\"initial\"\r\n      animate=\"animate\"\r\n      exit=\"exit\"\r\n    >\r\n      <div className=\"w-full max-w-md bg-white dark:bg-slate-900 min-h-screen shadow-2xl relative overflow-hidden flex flex-col\">\r\n        {/* Status Bar */}\r\n        <div className=\"px-8 pt-4 pb-2 flex justify-between items-center text-sm font-semibold z-10\">\r\n          <span>9:41</span>\r\n          <div className=\"flex gap-1.5 items-center\">\r\n            <span className=\"material-symbols-rounded text-base\">signal_cellular_4_bar</span>\r\n            <span className=\"material-symbols-rounded text-base\">wifi</span>\r\n            <span className=\"material-symbols-rounded text-base\">battery_very_low</span>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Header */}\r\n        <header className=\"px-6 pt-0 pb-6 flex justify-between items-center z-10\">\r\n          <Link to=\"/profile\" className=\"block w-10 h-10 rounded-full overflow-hidden border-2 border-slate-200 dark:border-slate-700 hover:opacity-80 transition-opacity\">\r\n            <img \r\n              alt=\"User profile\" \r\n              className=\"w-full h-full object-cover\" \r\n              src=\"https://lh3.googleusercontent.com/aida-public/AB6AXuCroTqMPe_xV0ZFnpYoABSvVyaoh31KnSiJZav4iMdjOiTI4bkLPvpzzpDCpl_c0D2jR-RUHhvAYXOoY5l3XahVjT1R8ZNRXB4BI31Zof7pBElaDn0aMGKuerS8p4Pmw3AEWf-dA8y1Cgy64kC56j8RCkETLm5Tda0J0KdP6oEjOntqHkbiCUn235GlIN40\"\r\n            />\r\n          </Link>\r\n          <div className=\"bg-slate-100 dark:bg-slate-800 p-1 rounded-full flex gap-1\">\r\n            <button className=\"bg-white dark:bg-slate-700 px-6 py-1.5 rounded-full text-sm font-bold shadow-sm\">Chart</button>\r\n            <button className=\"px-6 py-1.5 rounded-full text-sm font-medium text-slate-500 dark:text-slate-400\">Meals</button>\r\n          </div>\r\n          <button className=\"w-10 h-10 flex items-center justify-center bg-slate-100 dark:bg-slate-800 rounded-full\">\r\n            <span className=\"material-symbols-rounded\">menu</span>\r\n          </button>\r\n        </header>\r\n\r\n        {/* Main Content */}\r\n        <main className=\"flex-1 overflow-y-auto no-scrollbar pb-24 z-10\">\r\n\r\n          <section className=\"px-6 mb-10 mt-6\">\r\n            <div className=\"flex gap-2 overflow-x-auto no-scrollbar py-2\">\r\n              <button onClick={() => setTimeRange('today')} className={`px-5 py-2 rounded-full whitespace-nowrap ${timeRange === 'today' ? 'bg-slate-100 dark:bg-slate-800 text-sm font-bold text-slate-900 dark:text-slate-100' : 'text-slate-400 text-sm font-medium'}`}>Today</button>\r\n              <button onClick={() => setTimeRange('week')} className={`px-5 py-2 rounded-full whitespace-nowrap ${timeRange === 'week' ? 'bg-slate-100 dark:bg-slate-800 text-sm font-bold text-slate-900 dark:text-slate-100' : 'text-slate-400 text-sm font-medium'}`}>Week</button>\r\n              <button onClick={() => setTimeRange('month')} className={`px-5 py-2 rounded-full whitespace-nowrap ${timeRange === 'month' ? 'bg-slate-100 dark:bg-slate-800 text-sm font-bold text-slate-900 dark:text-slate-100' : 'text-slate-400 text-sm font-medium'}`}>Month</button>\r\n              <button onClick={() => setTimeRange('3months')} className={`px-5 py-2 rounded-full whitespace-nowrap ${timeRange === '3months' ? 'bg-slate-100 dark:bg-slate-800 text-sm font-bold text-slate-900 dark:text-slate-100' : 'text-slate-400 text-sm font-medium'}`}>3 Months</button>\r\n            </div>\r\n          </section>\r\n\r\n          {/* Chart Section */}\r\n          <section className=\"flex flex-col items-center justify-center relative mb-12\">\r\n            <div className=\"absolute inset-0 z-20 pointer-events-none\">\r\n              {/* Labels positionnement trigonométrique */}\r\n              {(() => {\r\n                if (totals.calories === 0) return null;\r\n                \r\n                // Rayon du cercle sur lequel placer les étiquettes (légèrement au bord du donut)\r\n                const radius = 138; \r\n                const center = 130; // 260px / 2 (la taille du \".nutrition-chart-ring\")\r\n\r\n                // Le conic-gradient CSS commence avec \"from 180deg\", soit le BAS du cercle.\r\n                // 180 degrés = Math.PI radians (offset = PI / 2 dans notre trigonométrie)\r\n                const getCoords = (percent) => {\r\n                  // Le sens horaire classique : angle = % * 2*PI\r\n                  // L'offset pour démarrer \"en bas\" c'est + Math.PI/2 (par rapport à 0 qui est géométriquement à droite)\r\n                  const angle = (percent / 100) * 2 * Math.PI + (Math.PI / 2); \r\n                  const x = center + radius * Math.cos(angle);\r\n                  const y = center + radius * Math.sin(angle);\r\n                  return { x, y };\r\n                };\r\n\r\n                // Calculs des centres idéaux de chaque segment de couleur\r\n                // Protéines: de 0 à P\r\n                const pCenterPercent = percentages.protein / 2;\r\n                // Glucides: de P à P+C\r\n                const cCenterPercent = percentages.protein + (percentages.carbs / 2);\r\n                // Lipides: de P+C à 100\r\n                const fCenterPercent = percentages.protein + percentages.carbs + (percentages.fats / 2);\r\n\r\n                const pCoords = getCoords(pCenterPercent);\r\n                const cCoords = getCoords(cCenterPercent);\r\n                const fCoords = getCoords(fCenterPercent);\r\n\r\n                return (\r\n                  <div className=\"relative w-[260px] h-[260px] mx-auto\">\r\n                    {percentages.protein > 0 && (\r\n                      <div \r\n                        className=\"absolute flex items-center gap-1.5 bg-white/80 dark:bg-black/80 backdrop-blur-md px-2 py-1 rounded-full shadow-md transform -translate-x-1/2 -translate-y-1/2 transition-all duration-500\"\r\n                        style={{ left: `${pCoords.x}px`, top: `${pCoords.y}px` }}\r\n                      >\r\n                        <span className=\"text-[10px] font-black tracking-wide text-[#8b93ff]\">{percentages.protein}% P</span>\r\n                      </div>\r\n                    )}\r\n                    {percentages.carbs > 0 && (\r\n                      <div \r\n                        className=\"absolute flex items-center gap-1.5 bg-white/80 dark:bg-black/80 backdrop-blur-md px-2 py-1 rounded-full shadow-md transform -translate-x-1/2 -translate-y-1/2 transition-all duration-500\"\r\n                        style={{ left: `${cCoords.x}px`, top: `${cCoords.y}px` }}\r\n                      >\r\n                        <span className=\"text-[10px] font-black tracking-wide text-[#7ee0b3]\">{percentages.carbs}% C</span>\r\n                      </div>\r\n                    )}\r\n                    {percentages.fats > 0 && (\r\n                      <div \r\n                        className=\"absolute flex items-center gap-1.5 bg-white/80 dark:bg-black/80 backdrop-blur-md px-2 py-1 rounded-full shadow-md transform -translate-x-1/2 -translate-y-1/2 transition-all duration-500\"\r\n                        style={{ left: `${fCoords.x}px`, top: `${fCoords.y}px` }}\r\n                      >\r\n                        <span className=\"text-[10px] font-black tracking-wide text-[#ffad84]\">{percentages.fats}% F</span>\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                );\r\n              })()}\r\n            </div>\r\n            \r\n            <div \r\n              className=\"nutrition-chart-ring shadow-inner\"\r\n              style={{\r\n                /*\r\n                  Calcul du gradient conique (tarte) dynamique :\r\n                  Protéines (indigo) -> de 0% à protein%\r\n                  Glucides (vert) -> de protein% à protein+carbs%\r\n                  Lipides (orange) -> de protein+carbs% à 100%\r\n                  S'il n'y a pas de repas (0 0 0), on affiche du gris\r\n                */\r\n                background: totals.calories > 0 \r\n                  ? `conic-gradient(\r\n                      from 180deg,\r\n                      #8b93ff 0% ${percentages.protein}%,\r\n                      #7ee0b3 ${percentages.protein}% ${percentages.protein + percentages.carbs}%,\r\n                      #ffad84 ${percentages.protein + percentages.carbs}% 100%\r\n                    )`\r\n                  : 'conic-gradient(from 180deg, #e2e8f0 0% 100%)'\r\n              }}\r\n            >\r\n              <div className=\"z-10 text-center flex flex-col items-center\">\r\n                <span className=\"text-xs font-bold text-slate-400 uppercase tracking-widest\">Consumed:</span>\r\n                <span className=\"text-5xl font-extrabold my-1\">{totals.calories}</span>\r\n                <span className=\"text-lg font-bold text-slate-600 dark:text-slate-300\">Kcal</span>\r\n              </div>\r\n            </div>\r\n          </section>\r\n\r\n          {/* Meals Section */}\r\n          <section className=\"px-6\">\r\n            <div className=\"flex gap-4 overflow-x-auto no-scrollbar pb-4 -mx-6 px-6\">\r\n              {meals.length > 0 ? (\r\n                meals.map((meal, index) => {\r\n                  const colors = ['orange', 'emerald', 'purple', 'blue'];\r\n                  const colorMatch = colors[index % colors.length];\r\n                  const bgClass = `bg-${colorMatch}-100 dark:bg-${colorMatch}-900/30`;\r\n                  const textClass = `text-${colorMatch}-700 dark:text-${colorMatch}-300`;\r\n\r\n                  return (\r\n                    <div \r\n                      key={meal.id} \r\n                      onClick={() => setSelectedMeal(meal)}\r\n                      className={`min-w-[130px] w-[130px] ${bgClass} rounded-2xl p-3 flex flex-col justify-between aspect-[3/4] cursor-pointer relative overflow-hidden group transition-transform hover:scale-[1.02]`}\r\n                    >\r\n                      <div className=\"absolute top-2 right-2 bg-white/80 dark:bg-black/40 backdrop-blur-md px-1.5 py-0.5 rounded-lg text-[9px] font-bold z-10\">{meal.calories} kcal</div>\r\n                      <img alt={meal.name} className=\"w-16 h-16 object-cover rounded-xl mx-auto mt-4 shadow-lg rotate-1 group-hover:rotate-0 transition-transform\" src={getMealImage(meal)}/>\r\n                      <div className=\"mt-2\">\r\n                        <h3 className=\"font-bold text-xs line-clamp-1\">{meal.name}</h3>\r\n                        <p className={`text-[9px] ${textClass} line-clamp-1 mt-0.5`}>{meal.ingredients || \"Scanned meal\"}</p>\r\n                      </div>\r\n                    </div>\r\n                  );\r\n                })\r\n              ) : (\r\n                <div className=\"w-full text-center py-6 text-slate-400\">\r\n                  <span className=\"material-symbols-rounded text-4xl opacity-50 block mb-2\">restaurant</span>\r\n                  <p className=\"font-medium text-sm\">No meals logged today</p>\r\n                </div>\r\n              )}\r\n            </div>\r\n          </section>\r\n\r\n          <section className=\"px-6 mt-4 pb-8\">\r\n            <BmiWidget />\r\n          </section>\r\n        </main>\r\n\r\n        {/* Bottom Navigation */}\r\n        <nav className=\"absolute bottom-6 left-1/2 -translate-x-1/2 w-[90%] bg-slate-900/90 dark:bg-white/90 backdrop-blur-xl h-18 rounded-full flex items-center justify-around px-6 py-4 shadow-2xl z-50\">\r\n          <Link to=\"/\" className=\"flex flex-col items-center gap-1 text-white dark:text-slate-900\">\r\n            <span className=\"material-symbols-rounded fill-[1]\">home</span>\r\n          </Link>\r\n          <button className=\"flex flex-col items-center gap-1 text-slate-500\">\r\n            <span className=\"material-symbols-rounded\">camera_enhance</span>\r\n          </button>\r\n          <div className=\"relative -top-8\">\r\n            <Link to=\"/scanner\" className=\"w-16 h-16 bg-primary rounded-full flex items-center justify-center shadow-xl border-4 border-white dark:border-slate-900\">\r\n              <span className=\"material-symbols-rounded text-white text-3xl\">add</span>\r\n            </Link>\r\n          </div>\r\n          <button className=\"flex flex-col items-center gap-1 text-slate-500\">\r\n            <span className=\"material-symbols-rounded\">restaurant_menu</span>\r\n          </button>\r\n          <Link to=\"/stats\" className=\"flex flex-col items-center gap-1 text-slate-500 transition-transform active:scale-95\">\r\n            <span className=\"material-symbols-rounded\">bar_chart</span>\r\n          </Link>\r\n        </nav>\r\n        \r\n        <div className=\"absolute bottom-1.5 left-1/2 -translate-x-1/2 w-32 h-1.5 bg-slate-400/30 rounded-full z-50\"></div>\r\n        \r\n        {/* Meal Detail Modal */}\r\n        <AnimatePresence>\r\n          {selectedMeal && (\r\n            <motion.div\r\n              initial={{ opacity: 0 }}\r\n              animate={{ opacity: 1 }}\r\n              exit={{ opacity: 0 }}\r\n              className=\"absolute inset-0 z-[60] flex flex-col justify-end bg-black/60 backdrop-blur-sm\"\r\n              onClick={() => setSelectedMeal(null)}\r\n            >\r\n              <motion.div\r\n                initial={{ y: \"100%\" }}\r\n                animate={{ y: 0 }}\r\n                exit={{ y: \"100%\" }}\r\n                transition={{ type: \"spring\", damping: 25, stiffness: 200 }}\r\n                className=\"w-full bg-white dark:bg-slate-900 rounded-t-[40px] p-6 pb-12 shadow-2xl relative\"\r\n                onClick={(e) => e.stopPropagation()}\r\n              >\r\n                <div className=\"w-12 h-1.5 bg-slate-300 dark:bg-slate-700 rounded-full mx-auto mb-6\" />\r\n                \r\n                <div className=\"flex gap-4 items-center mb-6\">\r\n                  <img src={getMealImage(selectedMeal)} alt={selectedMeal.name} className=\"w-24 h-24 rounded-3xl object-cover shadow-lg\" />\r\n                  <div>\r\n                    <h2 className=\"text-2xl font-black\">{selectedMeal.name}</h2>\r\n                    <p className=\"text-slate-500 font-bold mt-1\">{selectedMeal.calories} Kcal Total</p>\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"grid grid-cols-3 gap-3 mb-6\">\r\n                  <div className=\"bg-slate-50 dark:bg-slate-800 rounded-2xl p-3 text-center\">\r\n                    <span className=\"block text-indigo-500 text-[10px] uppercase font-bold mb-1\">Protein</span>\r\n                    <span className=\"font-bold text-lg\">{selectedMeal.protein}g</span>\r\n                  </div>\r\n                  <div className=\"bg-slate-50 dark:bg-slate-800 rounded-2xl p-3 text-center\">\r\n                    <span className=\"block text-emerald-500 text-[10px] uppercase font-bold mb-1\">Carbs</span>\r\n                    <span className=\"font-bold text-lg\">{selectedMeal.carbs}g</span>\r\n                  </div>\r\n                  <div className=\"bg-slate-50 dark:bg-slate-800 rounded-2xl p-3 text-center\">\r\n                    <span className=\"block text-orange-500 text-[10px] uppercase font-bold mb-1\">Fats</span>\r\n                    <span className=\"font-bold text-lg\">{selectedMeal.fats}g</span>\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"mb-6\">\r\n                  <h3 className=\"font-bold text-lg mb-3\">Ingredients</h3>\r\n                  <p className=\"text-sm text-slate-600 dark:text-slate-400 bg-slate-50 dark:bg-slate-800/50 p-4 rounded-2xl leading-relaxed\">\r\n                    {selectedMeal.ingredients || \"No specific ingredients found.\"}\r\n                  </p>\r\n                </div>\r\n\r\n                <div className=\"flex gap-3\">\r\n                  <button \r\n                    onClick={async () => {\r\n                      if(window.confirm(\"Êtes-vous sûr de vouloir supprimer ce repas ?\")) {\r\n                        await deleteMeal(selectedMeal.id);\r\n                        setSelectedMeal(null);\r\n                      }\r\n                    }}\r\n                    className=\"w-1/4 bg-red-100 dark:bg-red-900/30 text-red-600 dark:text-red-400 py-4 rounded-2xl font-bold flex items-center justify-center active:scale-95 transition-transform\"\r\n                  >\r\n                    <span className=\"material-symbols-rounded\">delete</span>\r\n                  </button>\r\n                  <button \r\n                    onClick={() => setSelectedMeal(null)}\r\n                    className=\"w-3/4 bg-slate-900 dark:bg-slate-100 text-white dark:text-slate-900 py-4 rounded-2xl font-bold text-lg active:scale-95 transition-transform\"\r\n                  >\r\n                    Close Summary\r\n                  </button>\r\n                </div>\r\n              </motion.div>\r\n            </motion.div>\r\n          )}\r\n        </AnimatePresence>\r\n\r\n        {/* Premium Upgrade Modal */}\r\n        <PremiumUpgrade \r\n          isOpen={showPremiumModal} \r\n          onClose={() => setShowPremiumModal(false)} \r\n        />\r\n      </div>\r\n    </motion.div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\pc\\.gemini\\antigravity\\scratch\\ai-calorie-app\\src\\pages\\PremiumUpgrade.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":2,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[37,44],"text":""},"desc":"Remove unused variable 'motion'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\n\r\nconst pageVariants = {\r\n  initial: { opacity: 0, scale: 0.95, y: 20 },\r\n  animate: { opacity: 1, scale: 1, y: 0, transition: { duration: 0.4, ease: 'easeOut' } },\r\n  exit: { opacity: 0, scale: 0.95, y: 20, transition: { duration: 0.3 } },\r\n};\r\n\r\nexport default function PremiumUpgrade({ isOpen, onClose }) {\r\n  return (\r\n    <AnimatePresence>\r\n      {isOpen && (\r\n        <div className=\"fixed inset-0 z-[100] flex items-center justify-center bg-black/60 backdrop-blur-sm p-4 font-display antialiased\">\r\n          <motion.div\r\n            variants={pageVariants}\r\n            initial=\"initial\"\r\n            animate=\"animate\"\r\n            exit=\"exit\"\r\n            className=\"relative w-full max-w-[400px] max-h-[90vh] bg-[#1a2210] rounded-[2.5rem] shadow-2xl flex flex-col overflow-hidden text-slate-100\"\r\n          >\r\n            {/* Background Image with Overlay */}\r\n            <div \r\n              className=\"absolute inset-0 z-0 bg-cover bg-center\" \r\n              style={{ backgroundImage: 'url(\"https://lh3.googleusercontent.com/aida-public/AB6AXuCmnNAYreMBeFQXqpJPbATpoosJkHsUc4CzxPmivMQLPSqtEt3P_kEeDsimTnsA6hLwkNX4f4VrrOCvmKWHNQmBiM4RIHqTuhCgsSMVopl8dxvqDCU42Rqbmkqqu1L4KTwfdPbS-Ri7Co0goaoLU_9F8LYvfJVvcHsEQAzW7OzKYC1X85JARphbUnC4eC7V1GD4qghWET7WjUUMj9yaIDbBBXmKpu0Cy00lzFhjZH0nYIyCzWtzfpWcRwpJqQJYvoHkBN1MQ9DCRP_J\")' }}\r\n            ></div>\r\n            <div \r\n              className=\"absolute inset-0 z-0 bg-[#1a2210]/80\"\r\n              style={{ background: 'linear-gradient(180deg, rgba(26, 34, 16, 0.4) 0%, rgba(26, 34, 16, 0.95) 60%, rgba(26, 34, 16, 1) 100%)' }}\r\n            ></div>\r\n\r\n            {/* Content Container */}\r\n            <div className=\"relative z-10 flex flex-col h-full w-full overflow-y-auto no-scrollbar p-6 pt-10 pb-8\">\r\n          \r\n          {/* Close Button */}\r\n          <button \r\n            onClick={onClose} \r\n            className=\"absolute top-6 right-6 z-50 p-2 bg-black/20 backdrop-blur-md rounded-full text-white hover:bg-black/40 transition-colors\"\r\n          >\r\n            <span className=\"material-symbols-rounded block\">close</span>\r\n          </button>\r\n\r\n          {/* Header / Logo Area */}\r\n          <div className=\"flex justify-center mb-8 mt-4\">\r\n            <div className=\"flex items-center gap-2\">\r\n              <span className=\"material-symbols-rounded text-[#9df425] text-4xl\">eco</span>\r\n              <h1 className=\"text-white text-2xl font-bold tracking-tight\">Glymo AI</h1>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Hero Text */}\r\n          <div className=\"text-center mb-8\">\r\n            <h2 className=\"text-white text-4xl font-bold leading-tight mb-2\">Unlock Full<br/>Potential</h2>\r\n            <p className=\"text-gray-300 text-lg font-medium\">Get your dream body faster.</p>\r\n          </div>\r\n\r\n          {/* Plan Card */}\r\n          <div className=\"bg-white/5 backdrop-blur-md border border-white/10 rounded-xl p-6 mb-8 shadow-xl\">\r\n            <div className=\"flex justify-between items-start mb-4\">\r\n              <div>\r\n                <h3 className=\"text-white text-xl font-bold\">Annual Plan</h3>\r\n                <p className=\"text-[#9df425] text-sm font-medium mt-1\">First 7 days free, then $59.99/year</p>\r\n              </div>\r\n              <span className=\"bg-[#9df425] text-[#1a2210] text-xs font-bold px-3 py-1 rounded-full\">Save 50%</span>\r\n            </div>\r\n            \r\n            <div className=\"flex items-baseline gap-1 text-white mb-6\">\r\n              <span className=\"text-5xl font-bold tracking-tight\">$4.99</span>\r\n              <span className=\"text-gray-400 text-lg font-medium\">/mo</span>\r\n              <span className=\"text-gray-500 text-sm ml-2 line-through\">$9.99</span>\r\n            </div>\r\n            \r\n            <div className=\"flex flex-col gap-3\">\r\n              <div className=\"flex items-center gap-3 text-sm text-gray-200\">\r\n                <span className=\"material-symbols-rounded text-[#9df425] text-[20px]\">check_circle</span>\r\n                <span>Unlimited AI Logging</span>\r\n              </div>\r\n              <div className=\"flex items-center gap-3 text-sm text-gray-200\">\r\n                <span className=\"material-symbols-rounded text-[#9df425] text-[20px]\">check_circle</span>\r\n                <span>Advanced Macro Analysis</span>\r\n              </div>\r\n              <div className=\"flex items-center gap-3 text-sm text-gray-200\">\r\n                <span className=\"material-symbols-rounded text-[#9df425] text-[20px]\">check_circle</span>\r\n                <span>Personalized Meal Plans</span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Comparison Table */}\r\n          <div className=\"mb-8 px-2\">\r\n            <div className=\"grid grid-cols-3 gap-4 mb-4 text-center border-b border-white/10 pb-2\">\r\n              <div className=\"text-left text-gray-400 text-sm font-medium\">Features</div>\r\n              <div className=\"text-gray-400 text-sm font-medium\">Free</div>\r\n              <div className=\"text-[#9df425] text-sm font-bold\">Premium</div>\r\n            </div>\r\n            \r\n            <div className=\"space-y-4\">\r\n              <div className=\"grid grid-cols-3 gap-4 items-center text-center\">\r\n                <div className=\"text-left text-gray-200 text-sm\">Food Scan</div>\r\n                <div className=\"text-gray-400\">\r\n                  <span className=\"material-symbols-rounded text-[18px]\">check</span>\r\n                </div>\r\n                <div className=\"text-[#9df425]\">\r\n                  <span className=\"material-symbols-rounded text-[18px]\">check</span>\r\n                </div>\r\n              </div>\r\n              \r\n              <div className=\"grid grid-cols-3 gap-4 items-center text-center\">\r\n                <div className=\"text-left text-gray-200 text-sm\">Macro Details</div>\r\n                <div className=\"text-gray-500\">\r\n                  <span className=\"material-symbols-rounded text-[18px]\">close</span>\r\n                </div>\r\n                <div className=\"text-[#9df425]\">\r\n                  <span className=\"material-symbols-rounded text-[18px]\">check</span>\r\n                </div>\r\n              </div>\r\n              \r\n              <div className=\"grid grid-cols-3 gap-4 items-center text-center\">\r\n                <div className=\"text-left text-gray-200 text-sm\">Recipes</div>\r\n                <div className=\"text-gray-500 text-sm\">Limited</div>\r\n                <div className=\"text-[#9df425] font-bold text-sm\">All Access</div>\r\n              </div>\r\n              \r\n              <div className=\"grid grid-cols-3 gap-4 items-center text-center\">\r\n                <div className=\"text-left text-gray-200 text-sm\">Ad-Free</div>\r\n                <div className=\"text-gray-500\">\r\n                  <span className=\"material-symbols-rounded text-[18px]\">close</span>\r\n                </div>\r\n                <div className=\"text-[#9df425]\">\r\n                  <span className=\"material-symbols-rounded text-[18px]\">check</span>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* CTA Button */}\r\n          <div className=\"mt-auto\">\r\n            <button \r\n              onClick={() => alert(\"Payment Processing Integration Pending\")}\r\n              className=\"w-full bg-[#9df425] hover:bg-[#8ce01f] text-[#1a2210] text-lg font-bold py-4 px-6 rounded-full transition-all duration-200 transform active:scale-95 shadow-lg shadow-[#9df425]/20 flex items-center justify-center gap-2\"\r\n            >\r\n              Start 7-Day Free Trial\r\n              <span className=\"material-symbols-rounded text-[24px]\">arrow_forward</span>\r\n            </button>\r\n            <p className=\"text-center text-gray-400 text-xs mt-4\">Cancel anytime in Settings &gt; Subscriptions.</p>\r\n            \r\n            <div className=\"flex justify-center gap-6 mt-4 pb-4\">\r\n              <button className=\"text-gray-500 text-xs hover:text-white transition-colors\">Restore Purchase</button>\r\n              <button className=\"text-gray-500 text-xs hover:text-white transition-colors\">Terms</button>\r\n              <button className=\"text-gray-500 text-xs hover:text-white transition-colors\">Privacy</button>\r\n            </div>\r\n          </div>\r\n          \r\n            </div>\r\n          </motion.div>\r\n        </div>\r\n      )}\r\n    </AnimatePresence>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\pc\\.gemini\\antigravity\\scratch\\ai-calorie-app\\src\\pages\\Profile.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":3,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[102,141],"text":""},"desc":"Remove unused variable 'motion'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { motion } from 'framer-motion';\r\nimport { supabase } from '../lib/supabase';\r\nimport { useMeals } from '../context/MealContext';\r\n\r\nexport default function Profile() {\r\n  const navigate = useNavigate();\r\n  const { meals } = useMeals();\r\n  const [profile, setProfile] = useState(null);\r\n  const [userEmail, setUserEmail] = useState(\"\");\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    const fetchProfile = async () => {\r\n      try {\r\n        const { data: { session } } = await supabase.auth.getSession();\r\n        if (session) {\r\n          setUserEmail(session.user.email || \"User\");\r\n          const { data, error } = await supabase\r\n            .from('profiles')\r\n            .select('*')\r\n            .eq('id', session.user.id)\r\n            .single();\r\n            \r\n          if (data && !error) {\r\n            setProfile(data);\r\n          }\r\n        }\r\n      } catch (error) {\r\n        console.error(\"Error loading profile:\", error);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    fetchProfile();\r\n  }, []);\r\n\r\n  // Compute stat totals based on context and profile state\r\n  const totalMealsLogged = meals.length;\r\n  const currentWeight = profile?.weight || localStorage.getItem('user_weight') || '--';\r\n  const calorieGoal = profile?.calorie_goal || localStorage.getItem('user_calorie_goal') || '--';\r\n  const displayName = profile?.full_name || userEmail.split('@')[0] || 'User';\r\n  const userGoal = profile?.goal || localStorage.getItem('onboarding_goal') || 'maintain';\r\n  \r\n  const formatGoal = (g) => {\r\n    switch(g) {\r\n      case 'lose_weight': return 'Lose Weight';\r\n      case 'build_muscle': return 'Build Muscle';\r\n      case 'maintain': \r\n      case 'maintain_weight': return 'Maintain Weight';\r\n      default: return 'On Track';\r\n    }\r\n  };\r\n\r\n  // Check if they are premium from db\r\n  const isPremium = profile?.is_premium === true;\r\n\r\n  return (\r\n    <motion.div\r\n      initial={{ opacity: 0, x: 20 }}\r\n      animate={{ opacity: 1, x: 0 }}\r\n      exit={{ opacity: 0, x: -20 }}\r\n      transition={{ duration: 0.3 }}\r\n      className=\"bg-background-light dark:bg-slate-900 text-slate-900 dark:text-slate-100 antialiased min-h-screen flex flex-col overflow-x-hidden\"\r\n    >\r\n      <main className=\"flex-1 pb-10 relative z-0 bg-[#102210]\">\r\n        {/* Immersive Header with Glass Effect */}\r\n        <div className=\"relative w-full h-[340px] overflow-hidden rounded-b-xl\">\r\n          {/* Background Image */}\r\n          <div \r\n            className=\"absolute inset-0 bg-cover bg-center\" \r\n            style={{ backgroundImage: \"url('https://lh3.googleusercontent.com/aida-public/AB6AXuDnVsbRBnBn5gqFcEPva3jTmV-VoWZ5CTyHSZ33p9mbAXSFI1nQd_Sh7cA9Z5u38yK-q1P4RY5Yw3aVbuGeCbwgyTE40Zzg5UeQ3-omT_s1sz6D3-Td_K1POxc-NMYunnPDJz9gbgBvws3c_LAqvTDBpZa0xJ0DK3QdgoFu7C9RB8TjjvvVI_qq-F5feVQbakqVLas3qW2uM96tZnv4mlw5roFwL2h74MyQcwVcCLFN_gFcf-RrvIGUxJda3hsF7c9xo2xClX85Nxdm')\" }}\r\n          />\r\n          {/* Gradient Overlay for readability */}\r\n          <div className=\"absolute inset-0 bg-gradient-to-b from-black/40 via-[#102210]/60 to-[#102210]\"></div>\r\n          \r\n          {/* Top Bar Actions */}\r\n          <div className=\"absolute top-0 left-0 right-0 p-4 pt-6 flex justify-between items-center z-20\">\r\n            <button \r\n              onClick={() => navigate(-1)}\r\n              className=\"p-2 w-10 h-10 flex items-center justify-center rounded-full bg-black/20 backdrop-blur-md text-white hover:bg-black/30 transition-colors\"\r\n            >\r\n              <span className=\"material-symbols-rounded\">arrow_back</span>\r\n            </button>\r\n            <div className=\"text-white text-lg font-bold tracking-tight\">My Profile</div>\r\n            <div className=\"w-10 h-10\"></div> {/* Spacer to keep title centered */}\r\n          </div>\r\n          \r\n          {/* User Profile Info */}\r\n          <div className=\"absolute bottom-0 left-0 right-0 flex flex-col items-center justify-end pb-8 z-20\">\r\n            <div className=\"relative group\">\r\n              <div className=\"w-28 h-28 rounded-full border-4 border-[#0fbd0f] p-1 bg-[#102210]/50 backdrop-blur-sm\">\r\n                <img \r\n                  alt=\"User Avatar\" \r\n                  className=\"w-full h-full rounded-full object-cover\" \r\n                  src={profile?.avatar_url || \"https://lh3.googleusercontent.com/aida-public/AB6AXuDWlHU1WLj4HFNViDf-RPUhFhKnbYZOCqZ54QnaaKTJARoVo7GnKVEzjgqVgcaKjZyrgojgDpleqZV6DdjTeJJgmtVFDYonsuhGVAqx9vDMWvnAvHpkqEimNWXd8lDzviv8j__E0CCzraFRDCvwpsmKM0NZbt2UC42IaV5wAiGsob2mPL_UhPgeuOOhgqL0spzQjAu_XhSdlGGpGJ3-Pk-vBX-qGlR1fb-uuznNvumul9hX88Nrzi8YSVyaKw79iA1v_x74ql7BiiUz\"}\r\n                />\r\n              </div>\r\n              <button \r\n                onClick={() => alert(\"L'édition de profil arrive très bientôt !\")} \r\n                className=\"absolute bottom-0 right-0 bg-[#0fbd0f] text-white p-1.5 rounded-full border-4 border-[#102210] shadow-lg\"\r\n              >\r\n                <span className=\"material-symbols-rounded text-[16px] leading-none\">edit</span>\r\n              </button>\r\n            </div>\r\n            \r\n            <h1 className=\"text-2xl font-bold mt-3 text-white\">\r\n              {loading ? \"Loading...\" : displayName}\r\n            </h1>\r\n            <div className=\"flex items-center gap-2 mt-1\">\r\n              <span className=\"bg-gradient-to-r from-[#0fbd0f] to-emerald-400 text-transparent bg-clip-text font-bold text-sm\">\r\n                {isPremium ? \"GLYMO PRO MEMBER\" : \"FREE PLAN\"}\r\n              </span>\r\n              {isPremium && (\r\n                <span className=\"material-symbols-rounded text-[#0fbd0f] text-[18px]\" style={{ fontVariationSettings: \"'FILL' 1\" }}>verified</span>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Scrollable Content Container */}\r\n        <div className=\"px-5 -mt-6 relative z-10 flex flex-col gap-5\">\r\n          {/* Transformation Card */}\r\n          <div className=\"bg-[#1a2e1a]/90 backdrop-blur-xl border border-white/5 p-5 rounded-lg shadow-xl overflow-hidden relative\">\r\n            <div className=\"absolute top-0 right-0 w-32 h-32 bg-[#0fbd0f]/10 rounded-full blur-3xl -mr-10 -mt-10\"></div>\r\n            <div className=\"flex justify-between items-start mb-4 relative z-10\">\r\n              <div>\r\n                <h2 className=\"text-white/60 text-sm font-medium uppercase tracking-wider\">Transformation</h2>\r\n                <div className=\"flex items-baseline gap-2 mt-1\">\r\n                  <span className=\"text-3xl font-bold text-white\">{currentWeight} kg</span>\r\n                  <span className=\"text-slate-400 text-sm font-medium ml-2\">Goal: {calorieGoal} kcal/day</span>\r\n                </div>\r\n                <p className=\"text-white/40 text-xs mt-1\">Updated recently</p>\r\n              </div>\r\n              <button \r\n                onClick={() => navigate('/stats')} \r\n                className=\"text-[#0fbd0f] hover:text-white transition-colors\"\r\n              >\r\n                <span className=\"material-symbols-rounded\">arrow_outward</span>\r\n              </button>\r\n            </div>\r\n            \r\n            {/* Graph */}\r\n            <div className=\"h-24 w-full relative z-10\">\r\n              <svg fill=\"none\" height=\"100%\" preserveAspectRatio=\"none\" viewBox=\"0 0 300 100\" width=\"100%\" xmlns=\"http://www.w3.org/2000/svg\">\r\n                <defs>\r\n                  <linearGradient id=\"graphGradient\" x1=\"0\" x2=\"0\" y1=\"0\" y2=\"1\">\r\n                    <stop offset=\"0%\" stopColor=\"#0fbd0f\" stopOpacity=\"0.3\"></stop>\r\n                    <stop offset=\"100%\" stopColor=\"#0fbd0f\" stopOpacity=\"0\"></stop>\r\n                  </linearGradient>\r\n                </defs>\r\n                <path d=\"M0,80 C50,80 50,40 100,40 C150,40 150,60 200,60 C250,60 250,10 300,10 V100 H0 Z\" fill=\"url(#graphGradient)\"></path>\r\n                <path d=\"M0,80 C50,80 50,40 100,40 C150,40 150,60 200,60 C250,60 250,10 300,10\" stroke=\"#0fbd0f\" strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"3\"></path>\r\n                <circle cx=\"100\" cy=\"40\" fill=\"#0fbd0f\" r=\"4\" stroke=\"#1a2e1a\" strokeWidth=\"2\"></circle>\r\n                <circle cx=\"200\" cy=\"60\" fill=\"#0fbd0f\" r=\"4\" stroke=\"#1a2e1a\" strokeWidth=\"2\"></circle>\r\n                <circle cx=\"300\" cy=\"10\" fill=\"#0fbd0f\" r=\"4\" stroke=\"#1a2e1a\" strokeWidth=\"2\"></circle>\r\n              </svg>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Features Grid */}\r\n          <div className=\"grid grid-cols-2 gap-4\">\r\n            <button \r\n              onClick={() => navigate('/')} \r\n              className=\"bg-[#1a2e1a]/60 hover:bg-[#1a2e1a] border border-white/5 p-5 rounded-lg flex flex-col items-center justify-center gap-3 text-center transition-all active:scale-95 group\"\r\n            >\r\n              <div className=\"w-14 h-14 rounded-full bg-emerald-900/40 flex items-center justify-center text-[#0fbd0f] group-hover:bg-[#0fbd0f] group-hover:text-white transition-colors\">\r\n                <span className=\"material-symbols-rounded text-3xl\">restaurant_menu</span>\r\n              </div>\r\n              <div>\r\n                <h3 className=\"font-bold text-white text-base\">My Recipes</h3>\r\n                <p className=\"text-white/40 text-xs mt-1\">{totalMealsLogged} Created</p>\r\n              </div>\r\n            </button>\r\n            <button \r\n              onClick={() => navigate('/results')} \r\n              className=\"bg-[#1a2e1a]/60 hover:bg-[#1a2e1a] border border-white/5 p-5 rounded-lg flex flex-col items-center justify-center gap-3 text-center transition-all active:scale-95 group\"\r\n            >\r\n              <div className=\"w-14 h-14 rounded-full bg-emerald-900/40 flex items-center justify-center text-[#0fbd0f] group-hover:bg-[#0fbd0f] group-hover:text-white transition-colors\">\r\n                <span className=\"material-symbols-rounded text-3xl\">qr_code_scanner</span>\r\n              </div>\r\n              <div>\r\n                <h3 className=\"font-bold text-white text-base\">Saved Scans</h3>\r\n                <p className=\"text-white/40 text-xs mt-1\">{totalMealsLogged} Scans</p>\r\n              </div>\r\n            </button>\r\n            <button \r\n              onClick={() => navigate('/stats')} \r\n              className=\"bg-[#1a2e1a]/60 hover:bg-[#1a2e1a] border border-white/5 p-5 rounded-lg flex flex-col items-center justify-center gap-3 text-center transition-all active:scale-95 group\"\r\n            >\r\n              <div className=\"w-14 h-14 rounded-full bg-emerald-900/40 flex items-center justify-center text-[#0fbd0f] group-hover:bg-[#0fbd0f] group-hover:text-white transition-colors\">\r\n                <span className=\"material-symbols-rounded text-3xl\">bar_chart</span>\r\n              </div>\r\n              <div>\r\n                <h3 className=\"font-bold text-white text-base\">Daily Reports</h3>\r\n                <p className=\"text-white/40 text-xs mt-1\">Analytics</p>\r\n              </div>\r\n            </button>\r\n            <button \r\n              onClick={() => navigate('/onboarding/goal')} \r\n              className=\"bg-[#1a2e1a]/60 hover:bg-[#1a2e1a] border border-white/5 p-5 rounded-lg flex flex-col items-center justify-center gap-3 text-center transition-all active:scale-95 group\"\r\n            >\r\n              <div className=\"w-14 h-14 rounded-full bg-emerald-900/40 flex items-center justify-center text-[#0fbd0f] group-hover:bg-[#0fbd0f] group-hover:text-white transition-colors\">\r\n                <span className=\"material-symbols-rounded text-3xl\">flag</span>\r\n              </div>\r\n              <div>\r\n                <h3 className=\"font-bold text-white text-base\">My Goals</h3>\r\n                <p className=\"text-white/40 text-xs mt-1 capitalize\">{formatGoal(userGoal)}</p>\r\n              </div>\r\n            </button>\r\n          </div>\r\n\r\n          {/* Premium Badge Banner */}\r\n          {isPremium ? (\r\n            <div className=\"mt-2 w-full p-0.5 rounded-lg bg-gradient-to-r from-[#0fbd0f]/50 to-emerald-600/50\">\r\n              <div className=\"bg-[#102210] rounded-[calc(2rem-2px)] p-4 flex items-center justify-between\">\r\n                <div className=\"flex items-center gap-3\">\r\n                  <div className=\"bg-[#0fbd0f]/20 p-2 rounded-full flex items-center justify-center\">\r\n                    <span className=\"material-symbols-rounded text-[#0fbd0f]\">diamond</span>\r\n                  </div>\r\n                  <div className=\"flex flex-col\">\r\n                    <span className=\"text-white font-bold text-sm\">Glymo Premium Active</span>\r\n                    <span className=\"text-white/50 text-xs\">Renews on Oct 24, 2024</span>\r\n                  </div>\r\n                </div>\r\n                <span className=\"material-symbols-rounded text-white/40\">chevron_right</span>\r\n              </div>\r\n            </div>\r\n          ) : (\r\n            <div \r\n              onClick={() => navigate('/', { state: { showPremium: true } })} \r\n              className=\"mt-2 w-full p-0.5 rounded-lg bg-gradient-to-r from-slate-700/50 to-slate-600/50 cursor-pointer hover:from-[#0fbd0f]/40 hover:to-emerald-600/40 transition-colors group\"\r\n            >\r\n              <div className=\"bg-[#102210] rounded-[calc(2rem-2px)] p-4 flex items-center justify-between\">\r\n                <div className=\"flex items-center gap-3\">\r\n                  <div className=\"bg-slate-800 p-2 rounded-full flex items-center justify-center group-hover:bg-[#0fbd0f]/20 transition-colors\">\r\n                    <span className=\"material-symbols-rounded text-slate-400 group-hover:text-[#0fbd0f] transition-colors\">star</span>\r\n                  </div>\r\n                  <div className=\"flex flex-col\">\r\n                    <span className=\"text-white font-bold text-sm\">Upgrade to Premium</span>\r\n                    <span className=\"text-white/50 text-xs\">Unlock all AI features</span>\r\n                  </div>\r\n                </div>\r\n                <span className=\"material-symbols-rounded text-white/40 group-hover:text-white transition-colors\">chevron_right</span>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* More Settings List */}\r\n          <div className=\"bg-[#1a2e1a]/40 border border-white/5 rounded-lg p-2 flex flex-col gap-1 mb-8\">\r\n            <button \r\n              onClick={async () => {\r\n                await supabase.auth.signOut();\r\n                localStorage.removeItem('onboarding_completed');\r\n                navigate('/welcome');\r\n              }}\r\n              className=\"flex items-center justify-between w-full p-3 hover:bg-white/5 rounded-lg transition-colors group\"\r\n            >\r\n              <div className=\"flex items-center gap-3\">\r\n                <span className=\"material-symbols-rounded text-white/60 group-hover:text-red-500 transition-colors\">logout</span>\r\n                <span className=\"text-red-400 group-hover:text-red-500 text-sm font-medium transition-colors\">Sign Out</span>\r\n              </div>\r\n              <span className=\"material-symbols-rounded text-white/30 text-lg\">chevron_right</span>\r\n            </button>\r\n            <div className=\"h-px bg-white/5 mx-3\"></div>\r\n            <button \r\n              onClick={() => alert(\"Besoin d'aide ? Contactez-nous à support@glymo.ai\")} \r\n              className=\"flex items-center justify-between w-full p-3 hover:bg-white/5 rounded-lg transition-colors group\"\r\n            >\r\n              <div className=\"flex items-center gap-3\">\r\n                <span className=\"material-symbols-rounded text-white/60 group-hover:text-[#0fbd0f] transition-colors\">help</span>\r\n                <span className=\"text-white text-sm font-medium\">Help &amp; Support</span>\r\n              </div>\r\n              <span className=\"material-symbols-rounded text-white/30 text-lg\">chevron_right</span>\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </main>\r\n    </motion.div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\pc\\.gemini\\antigravity\\scratch\\ai-calorie-app\\src\\pages\\ScanResults.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":3,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[83,122],"text":""},"desc":"Remove unused variable 'motion'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport { Link, useNavigate } from 'react-router-dom';\r\nimport { motion } from 'framer-motion';\r\nimport { useMeals } from '../context/MealContext';\r\n\r\nconst pageVariants = {\r\n  initial: { opacity: 0, y: 20 },\r\n  animate: { opacity: 1, y: 0, transition: { duration: 0.3 } },\r\n  exit: { opacity: 0, y: -20, transition: { duration: 0.2 } },\r\n};\r\n\r\nexport default function ScanResults() {\r\n  const navigate = useNavigate();\r\n  const { addMeal } = useMeals();\r\n  \r\n  // Hardcoded scanned data for demo flow\r\n  const mealData = {\r\n    name: \"Scanned Healthy Bowl\",\r\n    calories: 582,\r\n    protein: 42,\r\n    carbs: 12,\r\n    fats: 34,\r\n    raw_ingredients_text: \"Grilled Salmon, Fresh Avocado, Quinoa Base, Olive Oil Dressing\",\r\n    image_url: \"https://lh3.googleusercontent.com/aida-public/AB6AXuCZ0vh-R2bBPLbGmcfqAbmMemmpfCQHvlTt56im37k12xfL7-NVEWBqLSTS87p56zdpJi4OPJ-TJxUtGGsTj_NEHsGdzuSVqs7bbnmCu1mRFAWG7ETNBYTJV_5fi8-m72QFC9lLPmH6kZNoUH0_kKfsfCV3By_yNRk2bQZiv8Y7Er0uW1A37B3kdcTqWx671OKp_0ESuoYnM7d-ZAb7wtDiFh_qaQ-EqcbHG7WZNZmqnz_N0-EGUoU2uJOO6p9kxYMyIsXxbieKN8hN\",\r\n    ingredientsList: [\r\n      { name: \"Grilled Salmon\", weight_g: 150, calories: 240, protein: 34, carbs: 0, fats: 11, icon: \"set_meal\" },\r\n      { name: \"Fresh Avocado\", weight_g: 50, calories: 160, protein: 2, carbs: 8, fats: 15, icon: \"eco\" },\r\n      { name: \"Quinoa Base\", weight_g: 100, calories: 120, protein: 4, carbs: 21, fats: 2, icon: \"grass\" },\r\n      { name: \"Olive Oil Dressing\", weight_g: 15, calories: 62, protein: 0, carbs: 0, fats: 7, icon: \"opacity\" }\r\n    ]\r\n  };\r\n\r\n  const handleConfirm = async () => {\r\n    await addMeal(mealData);\r\n    navigate('/');\r\n  };\r\n\r\n  return (\r\n    <motion.div \r\n      className=\"bg-background-light dark:bg-background-dark font-inter text-slate-900 dark:text-slate-100 min-h-screen flex justify-center items-center p-0 sm:p-4\"\r\n      variants={pageVariants}\r\n      initial=\"initial\"\r\n      animate=\"animate\"\r\n      exit=\"exit\"\r\n    >\r\n      <div className=\"relative w-full max-w-[375px] h-[812px] max-h-screen bg-white dark:bg-slate-900 sm:rounded-[40px] shadow-2xl overflow-hidden sm:border-[8px] border-slate-900 dark:border-slate-800\">\r\n        \r\n        {/* Status Bar */}\r\n        <div className=\"absolute top-0 w-full h-11 flex justify-between items-center px-8 z-50 text-white\">\r\n          <span className=\"text-sm font-semibold\">9:41</span>\r\n          <div className=\"flex items-center space-x-1.5\">\r\n            <span className=\"material-icons-round text-sm\">signal_cellular_alt</span>\r\n            <span className=\"material-icons-round text-sm\">wifi</span>\r\n            <span className=\"material-icons-round text-sm\">battery_full</span>\r\n          </div>\r\n        </div>\r\n        \r\n        <div className=\"absolute top-3 left-1/2 -translate-x-1/2 w-32 h-8 bg-black rounded-3xl z-50\"></div>\r\n        \r\n        <div className=\"h-full overflow-y-auto no-scrollbar pt-11 pb-32\">\r\n          {/* Image Header Section */}\r\n          <div className=\"relative w-full aspect-square bg-slate-200 dark:bg-slate-800\">\r\n            <img \r\n              alt=\"Scanned Healthy Meal Bowl\" \r\n              className=\"w-full h-full object-cover\" \r\n              src={mealData.image_url}\r\n            />\r\n            <Link to=\"/scanner\" className=\"absolute top-4 left-6 w-10 h-10 rounded-full bg-white/20 dark:bg-black/20 ios-blur flex items-center justify-center text-white\">\r\n              <span className=\"material-icons-round\">arrow_back_ios_new</span>\r\n            </Link>\r\n            \r\n            <div className=\"absolute inset-0 pointer-events-none\">\r\n              <div className=\"absolute top-1/4 left-1/3 p-2 bg-indigo-500/90 text-white rounded-xl ios-blur text-[10px] font-bold shadow-lg animate-pulse\">\r\n                SALMON <br/> <span className=\"text-xs\">240 kcal</span>\r\n              </div>\r\n              <div className=\"absolute bottom-1/3 right-1/4 p-2 bg-emerald-500/90 text-white rounded-xl ios-blur text-[10px] font-bold shadow-lg\">\r\n                AVOCADO <br/> <span className=\"text-xs\">160 kcal</span>\r\n              </div>\r\n              <div className=\"absolute inset-8 border-2 border-primary-results/40 rounded-3xl animate-pulse\"></div>\r\n            </div>\r\n          </div>\r\n          \r\n          {/* Results Details */}\r\n          <div className=\"px-6 -mt-8 relative z-10\">\r\n            <div className=\"bg-card-light dark:bg-card-dark rounded-t-[32px] p-6 shadow-xl space-y-8\">\r\n              \r\n              <div className=\"text-center space-y-1\">\r\n                <h1 className=\"text-2xl font-bold tracking-tight\">Scan Results</h1>\r\n                <p className=\"text-slate-500 dark:text-slate-400 text-sm\">AI identified 4 ingredients</p>\r\n              </div>\r\n              \r\n              {/* Circular Chart Component */}\r\n              <div className=\"flex flex-col items-center justify-center\">\r\n                <div className=\"relative w-40 h-40 flex items-center justify-center\">\r\n                  <svg className=\"w-full h-full -rotate-90\">\r\n                    <circle className=\"text-slate-100 dark:text-slate-700\" cx=\"80\" cy=\"80\" fill=\"transparent\" r=\"70\" stroke=\"currentColor\" strokeWidth=\"12\"></circle>\r\n                    <circle cx=\"80\" cy=\"80\" fill=\"transparent\" r=\"70\" stroke=\"url(#gradient)\" strokeDasharray=\"440\" strokeDashoffset=\"110\" strokeLinecap=\"round\" strokeWidth=\"12\"></circle>\r\n                    <defs>\r\n                      <linearGradient id=\"gradient\" x1=\"0%\" x2=\"100%\" y1=\"0%\" y2=\"0%\">\r\n                        <stop offset=\"0%\" stopColor=\"#818cf8\"></stop>\r\n                        <stop offset=\"100%\" stopColor=\"#6366f1\"></stop>\r\n                      </linearGradient>\r\n                    </defs>\r\n                  </svg>\r\n                  <div className=\"absolute text-center\">\r\n                    <span className=\"text-4xl font-extrabold block\">{mealData.calories}</span>\r\n                    <span className=\"text-xs font-semibold text-slate-500 tracking-widest uppercase\">Kcal Total</span>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              \r\n              {/* Macros Breakdown */}\r\n              <div className=\"grid grid-cols-3 gap-3\">\r\n                <div className=\"bg-slate-50 dark:bg-slate-800/50 p-3 rounded-2xl text-center\">\r\n                  <span className=\"block text-[10px] font-bold text-indigo-500 uppercase mb-1\">Protein</span>\r\n                  <span className=\"text-lg font-bold\">{mealData.protein}g</span>\r\n                  <div className=\"w-full bg-slate-200 dark:bg-slate-700 h-1.5 rounded-full mt-2\">\r\n                    <div className=\"bg-indigo-500 h-full rounded-full w-[80%]\"></div>\r\n                  </div>\r\n                </div>\r\n                <div className=\"bg-slate-50 dark:bg-slate-800/50 p-3 rounded-2xl text-center\">\r\n                  <span className=\"block text-[10px] font-bold text-emerald-500 uppercase mb-1\">Carbs</span>\r\n                  <span className=\"text-lg font-bold\">{mealData.carbs}g</span>\r\n                  <div className=\"w-full bg-slate-200 dark:bg-slate-700 h-1.5 rounded-full mt-2\">\r\n                    <div className=\"bg-emerald-500 h-full rounded-full w-[30%]\"></div>\r\n                  </div>\r\n                </div>\r\n                <div className=\"bg-slate-50 dark:bg-slate-800/50 p-3 rounded-2xl text-center\">\r\n                  <span className=\"block text-[10px] font-bold text-orange-500 uppercase mb-1\">Fats</span>\r\n                  <span className=\"text-lg font-bold\">{mealData.fats}g</span>\r\n                  <div className=\"w-full bg-slate-200 dark:bg-slate-700 h-1.5 rounded-full mt-2\">\r\n                    <div className=\"bg-orange-500 h-full rounded-full w-[60%]\"></div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              \r\n              {/* Ingredients List */}\r\n              <div className=\"space-y-4\">\r\n                <div className=\"flex justify-between items-center px-1\">\r\n                  <h3 className=\"font-bold text-lg\">Ingredients</h3>\r\n                  <button className=\"text-primary-results text-sm font-semibold flex items-center\">\r\n                    <span className=\"material-icons-round text-sm mr-1\">add_circle</span>\r\n                    Add manual\r\n                  </button>\r\n                </div>\r\n                \r\n                <div className=\"space-y-3\">\r\n                  <div className=\"flex items-center bg-slate-50 dark:bg-slate-800/40 p-3 rounded-2xl border border-transparent hover:border-primary-results/20 transition-all\">\r\n                    <div className=\"w-12 h-12 rounded-xl bg-indigo-100 dark:bg-indigo-900/30 flex items-center justify-center text-indigo-600 dark:text-indigo-400\">\r\n                      <span className=\"material-icons-round\">set_meal</span>\r\n                    </div>\r\n                    <div className=\"ml-4 flex-1\">\r\n                      <h4 className=\"font-semibold\">Grilled Salmon</h4>\r\n                      <p className=\"text-xs text-slate-500 dark:text-slate-400\">150g • 1.2 oz Protein</p>\r\n                    </div>\r\n                    <div className=\"text-right\">\r\n                      <span className=\"block font-bold\">240 kcal</span>\r\n                      <span className=\"text-[10px] text-slate-400 uppercase font-bold\">Protein</span>\r\n                    </div>\r\n                  </div>\r\n                  \r\n                  <div className=\"flex items-center bg-slate-50 dark:bg-slate-800/40 p-3 rounded-2xl border border-transparent hover:border-primary-results/20 transition-all\">\r\n                    <div className=\"w-12 h-12 rounded-xl bg-emerald-100 dark:bg-emerald-900/30 flex items-center justify-center text-emerald-600 dark:text-emerald-400\">\r\n                      <span className=\"material-icons-round\">eco</span>\r\n                    </div>\r\n                    <div className=\"ml-4 flex-1\">\r\n                      <h4 className=\"font-semibold\">Fresh Avocado</h4>\r\n                      <p className=\"text-xs text-slate-500 dark:text-slate-400\">0.5 medium • Healthy Fats</p>\r\n                    </div>\r\n                    <div className=\"text-right\">\r\n                      <span className=\"block font-bold\">160 kcal</span>\r\n                      <span className=\"text-[10px] text-slate-400 uppercase font-bold\">Fats</span>\r\n                    </div>\r\n                  </div>\r\n                  \r\n                  <div className=\"flex items-center bg-slate-50 dark:bg-slate-800/40 p-3 rounded-2xl border border-transparent hover:border-primary-results/20 transition-all\">\r\n                    <div className=\"w-12 h-12 rounded-xl bg-orange-100 dark:bg-orange-900/30 flex items-center justify-center text-orange-600 dark:text-orange-400\">\r\n                      <span className=\"material-icons-round\">grass</span>\r\n                    </div>\r\n                    <div className=\"ml-4 flex-1\">\r\n                      <h4 className=\"font-semibold\">Quinoa Base</h4>\r\n                      <p className=\"text-xs text-slate-500 dark:text-slate-400\">100g • Fiber & Carbs</p>\r\n                    </div>\r\n                    <div className=\"text-right\">\r\n                      <span className=\"block font-bold\">120 kcal</span>\r\n                      <span className=\"text-[10px] text-slate-400 uppercase font-bold\">Carbs</span>\r\n                    </div>\r\n                  </div>\r\n                  \r\n                  <div className=\"flex items-center bg-slate-50 dark:bg-slate-800/40 p-3 rounded-2xl border border-transparent hover:border-primary-results/20 transition-all\">\r\n                    <div className=\"w-12 h-12 rounded-xl bg-yellow-100 dark:bg-yellow-900/30 flex items-center justify-center text-yellow-600 dark:text-yellow-400\">\r\n                      <span className=\"material-icons-round\">opacity</span>\r\n                    </div>\r\n                    <div className=\"ml-4 flex-1\">\r\n                      <h4 className=\"font-semibold\">Olive Oil Dressing</h4>\r\n                      <p className=\"text-xs text-slate-500 dark:text-slate-400\">1 tbsp • Mono-fats</p>\r\n                    </div>\r\n                    <div className=\"text-right\">\r\n                      <span className=\"block font-bold\">62 kcal</span>\r\n                      <span className=\"text-[10px] text-slate-400 uppercase font-bold\">Fats</span>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        \r\n        {/* Bottom Action Bar */}\r\n        <div className=\"absolute bottom-0 left-0 w-full p-6 pb-10 bg-gradient-to-t from-white via-white dark:from-slate-900 dark:via-slate-900 to-transparent\">\r\n          <button \r\n            onClick={handleConfirm}\r\n            className=\"w-full bg-primary-results hover:bg-indigo-600 text-white font-bold py-5 rounded-2xl shadow-xl shadow-indigo-500/30 flex items-center justify-center space-x-2 transition-transform active:scale-95\"\r\n          >\r\n            <span className=\"material-icons-round\">check_circle</span>\r\n            <span>Confirm & Log Meal</span>\r\n          </button>\r\n        </div>\r\n        \r\n        <div className=\"absolute bottom-2 left-1/2 -translate-x-1/2 w-32 h-1.5 bg-slate-300 dark:bg-slate-700 rounded-full\"></div>\r\n      </div>\r\n    </motion.div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\pc\\.gemini\\antigravity\\scratch\\ai-calorie-app\\src\\pages\\Scanner.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":3,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[70,109],"text":""},"desc":"Remove unused variable 'motion'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport { Link } from 'react-router-dom';\r\nimport { motion } from 'framer-motion';\r\n\r\nconst pageVariants = {\r\n  initial: { opacity: 0, scale: 0.98 },\r\n  animate: { opacity: 1, scale: 1, transition: { duration: 0.3 } },\r\n  exit: { opacity: 0, scale: 1.02, transition: { duration: 0.2 } },\r\n};\r\n\r\nexport default function Scanner() {\r\n  return (\r\n    <motion.div \r\n      className=\"bg-black flex items-center justify-center min-h-screen font-display\"\r\n      variants={pageVariants}\r\n      initial=\"initial\"\r\n      animate=\"animate\"\r\n      exit=\"exit\"\r\n    >\r\n      <div className=\"relative w-full max-w-[375px] h-[812px] max-h-screen bg-black sm:rounded-[40px] overflow-hidden shadow-2xl sm:border-[8px] border-zinc-800\">\r\n        \r\n        {/* Status Bar */}\r\n        <div className=\"absolute top-0 w-full z-50 px-8 py-4 flex justify-between items-center text-white\">\r\n          <span className=\"text-sm font-semibold\">9:41</span>\r\n          <div className=\"flex items-center gap-1.5\">\r\n            <span className=\"material-icons-round text-sm\">signal_cellular_alt</span>\r\n            <span className=\"material-icons-round text-sm\">wifi</span>\r\n            <span className=\"material-icons-round text-sm\">battery_full</span>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Camera View */}\r\n        <div className=\"absolute inset-0 bg-zinc-900\">\r\n          <img \r\n            alt=\"Avocado Toast on a plate\" \r\n            className=\"w-full h-full object-cover opacity-80\" \r\n            src=\"https://lh3.googleusercontent.com/aida-public/AB6AXuBvWTmVBIZWAAYd6lw6Vya1diTIK6xDKfCbzXdo0iD6L7qBEaQ9NAIhjkPHXbgt1vrMbxuKzRfjU_BPXNRZziAHVG-FjFhRopCnOWUgmk5mP7dG6k0KcJxGSTcqDUoP-w929Mt0v6Qf5mtGbZZjjCNtnRhq7DKnptGP4MqEr-KuAPsDy93xfGfPhi9HgY6ILzTP132x97uXrZ7RDljnpB7FY-dOkX-EsaFthRa5FqC_Ql0pEyB6J375ZbNBoYapevZU2SRMNfCAPHH7\"\r\n          />\r\n          <div className=\"absolute inset-0 camera-overlay\"></div>\r\n          \r\n          {/* Scanning Animation Line */}\r\n          <div className=\"absolute w-full scan-line z-10\"></div>\r\n          \r\n          {/* AR Tags */}\r\n          <div className=\"absolute top-[35%] left-[20%] z-20 animate-bounce transition-all duration-1000\" style={{ animationDuration: '3s' }}>\r\n            <div className=\"glass-tag bg-green-500/20 text-white rounded-2xl p-3 shadow-xl flex flex-col items-start gap-1 transform -rotate-3\">\r\n              <div className=\"flex items-center gap-2\">\r\n                <span className=\"bg-green-500 w-2 h-2 rounded-full animate-pulse\"></span>\r\n                <span className=\"text-xs font-bold tracking-wider uppercase opacity-80\">Avocado</span>\r\n              </div>\r\n              <span className=\"text-xl font-bold\">160 <span className=\"text-xs font-normal\">kcal</span></span>\r\n              <div className=\"text-[10px] opacity-70\">Estimated 80g</div>\r\n            </div>\r\n          </div>\r\n          \r\n          <div className=\"absolute top-[48%] right-[15%] z-20 animate-bounce\" style={{ animationDuration: '4s', animationDelay: '0.5s' }}>\r\n            <div className=\"glass-tag bg-yellow-500/20 text-white rounded-2xl p-3 shadow-xl flex flex-col items-start gap-1 transform rotate-6\">\r\n              <div className=\"flex items-center gap-2\">\r\n                <span className=\"bg-yellow-400 w-2 h-2 rounded-full animate-pulse\"></span>\r\n                <span className=\"text-xs font-bold tracking-wider uppercase opacity-80\">Poached Egg</span>\r\n              </div>\r\n              <span className=\"text-xl font-bold\">72 <span className=\"text-xs font-normal\">kcal</span></span>\r\n              <div className=\"text-[10px] opacity-70\">Large (50g)</div>\r\n            </div>\r\n          </div>\r\n          \r\n          <div className=\"absolute bottom-[40%] left-[40%] z-20 animate-bounce\" style={{ animationDuration: '3.5s', animationDelay: '1s' }}>\r\n            <div className=\"glass-tag bg-orange-500/20 text-white rounded-2xl p-3 shadow-xl flex flex-col items-start gap-1 transform -rotate-1\">\r\n              <div className=\"flex items-center gap-2\">\r\n                <span className=\"bg-orange-400 w-2 h-2 rounded-full animate-pulse\"></span>\r\n                <span className=\"text-xs font-bold tracking-wider uppercase opacity-80\">Sourdough</span>\r\n              </div>\r\n              <span className=\"text-xl font-bold\">110 <span className=\"text-xs font-normal\">kcal</span></span>\r\n              <div className=\"text-[10px] opacity-70\">1 thick slice</div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Top Controls */}\r\n        <div className=\"absolute top-12 left-0 w-full flex justify-between items-center px-6 z-30\">\r\n          <Link to=\"/\" className=\"w-10 h-10 rounded-full bg-black/30 backdrop-blur-md flex items-center justify-center text-white\">\r\n            <span className=\"material-icons-round\">chevron_left</span>\r\n          </Link>\r\n          <div className=\"bg-black/30 backdrop-blur-md rounded-full px-4 py-1.5 flex items-center gap-2\">\r\n            <span className=\"material-icons-round text-primary-scan text-sm\">auto_awesome</span>\r\n            <span className=\"text-white text-xs font-semibold uppercase tracking-widest\">AI Scanning</span>\r\n          </div>\r\n          <button className=\"w-10 h-10 rounded-full bg-black/30 backdrop-blur-md flex items-center justify-center text-white\">\r\n            <span className=\"material-icons-round text-sm\">flash_on</span>\r\n          </button>\r\n        </div>\r\n\r\n        {/* Bottom Controls */}\r\n        <div className=\"absolute bottom-0 w-full z-40 px-6 pb-12 pt-8 flex flex-col gap-8\">\r\n          {/* Total Bar */}\r\n          <div className=\"flex justify-center\">\r\n            <div className=\"bg-white/10 backdrop-blur-xl border border-white/20 px-6 py-3 rounded-full flex items-center gap-4 shadow-2xl\">\r\n              <div className=\"flex flex-col\">\r\n                <span className=\"text-[10px] text-white/60 uppercase font-bold tracking-widest\">Total Estimated</span>\r\n                <span className=\"text-white font-bold text-lg\">342 <span className=\"text-sm font-medium\">kcal</span></span>\r\n              </div>\r\n              <div className=\"h-8 w-[1px] bg-white/20\"></div>\r\n              <div className=\"flex -space-x-2\">\r\n                <div className=\"w-8 h-8 rounded-full border-2 border-zinc-900 bg-green-500 flex items-center justify-center text-[10px] text-white font-bold\">P</div>\r\n                <div className=\"w-8 h-8 rounded-full border-2 border-zinc-900 bg-yellow-500 flex items-center justify-center text-[10px] text-white font-bold\">F</div>\r\n                <div className=\"w-8 h-8 rounded-full border-2 border-zinc-900 bg-blue-500 flex items-center justify-center text-[10px] text-white font-bold\">C</div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          \r\n          {/* Action Buttons */}\r\n          <div className=\"flex justify-between items-center\">\r\n            <button className=\"w-12 h-12 rounded-2xl bg-white/10 backdrop-blur-md flex items-center justify-center text-white\">\r\n              <span className=\"material-icons-round\">photo_library</span>\r\n            </button>\r\n            \r\n            <Link to=\"/results\" className=\"relative flex items-center justify-center\">\r\n              <div className=\"w-20 h-20 rounded-full border-4 border-white/30 flex items-center justify-center\">\r\n                <div className=\"w-[60px] h-[60px] bg-white rounded-full shadow-lg flex items-center justify-center active:scale-90 transition-transform cursor-pointer\">\r\n                  <div className=\"w-full h-full rounded-full border-2 border-zinc-200\"></div>\r\n                </div>\r\n              </div>\r\n            </Link>\r\n            \r\n            <button className=\"w-12 h-12 rounded-2xl bg-white/10 backdrop-blur-md flex items-center justify-center text-white\">\r\n              <span className=\"material-icons-round\">history</span>\r\n            </button>\r\n          </div>\r\n          \r\n          {/* Mode Selector */}\r\n          <div className=\"flex justify-center gap-8 text-white/50 text-xs font-bold uppercase tracking-widest\">\r\n            <span>Barcode</span>\r\n            <span className=\"text-white relative\">\r\n              Meal\r\n              <span className=\"absolute -bottom-2 left-1/2 -translate-x-1/2 w-1 h-1 bg-white rounded-full\"></span>\r\n            </span>\r\n            <span>Recipe</span>\r\n          </div>\r\n        </div>\r\n        \r\n        {/* iOS Indicators */}\r\n        <div className=\"absolute top-2 left-1/2 -translate-x-1/2 w-32 h-8 bg-black rounded-3xl z-[60]\"></div>\r\n        <div className=\"absolute bottom-2 left-1/2 -translate-x-1/2 w-32 h-1.5 bg-white/40 rounded-full z-50\"></div>\r\n      </div>\r\n    </motion.div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\pc\\.gemini\\antigravity\\scratch\\ai-calorie-app\\src\\pages\\Statistics.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":3,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[83,122],"text":""},"desc":"Remove unused variable 'motion'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport { Link, useNavigate } from 'react-router-dom';\r\nimport { motion } from 'framer-motion';\r\nimport { useMeals } from '../context/MealContext';\r\n\r\nconst pageVariants = {\r\n  initial: { opacity: 0, x: 20 },\r\n  animate: { opacity: 1, x: 0, transition: { duration: 0.3 } },\r\n  exit: { opacity: 0, x: -20, transition: { duration: 0.2 } },\r\n};\r\n\r\nexport default function Statistics() {\r\n  const navigate = useNavigate();\r\n  const { getWeeklyStats, weightTrend, waterToday, bmi } = useMeals();\r\n  \r\n  const { weeklyData, totalWeeklyCalories, dailyAverage } = getWeeklyStats();\r\n\r\n  return (\r\n    <motion.div \r\n      className=\"bg-background-light dark:bg-background-dark font-display text-slate-900 dark:text-slate-100 min-h-screen flex justify-center\"\r\n      variants={pageVariants}\r\n      initial=\"initial\"\r\n      animate=\"animate\"\r\n      exit=\"exit\"\r\n    >\r\n      <div className=\"w-full max-w-md bg-white dark:bg-slate-900 min-h-screen shadow-2xl relative overflow-hidden flex flex-col\">\r\n        {/* Status Bar */}\r\n        <div className=\"px-8 pt-4 pb-2 flex justify-between items-center text-sm font-semibold z-10\">\r\n          <span>9:41</span>\r\n          <div className=\"flex gap-1.5 items-center\">\r\n            <span className=\"material-symbols-rounded text-base\">signal_cellular_4_bar</span>\r\n            <span className=\"material-symbols-rounded text-base\">wifi</span>\r\n            <span className=\"material-symbols-rounded text-base\">battery_full</span>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Header */}\r\n        <header className=\"px-6 pt-4 pb-4 flex justify-between items-center z-10\">\r\n          <button onClick={() => navigate(-1)} className=\"w-10 h-10 flex items-center justify-center bg-slate-100 dark:bg-slate-800 rounded-full active:scale-95 transition-transform\">\r\n            <span className=\"material-symbols-rounded\">arrow_back_ios_new</span>\r\n          </button>\r\n          <h1 className=\"text-xl font-bold\">Statistics</h1>\r\n          <button className=\"w-10 h-10 flex items-center justify-center bg-slate-100 dark:bg-slate-800 rounded-full active:scale-95 transition-transform\">\r\n            <span className=\"material-symbols-rounded\">calendar_today</span>\r\n          </button>\r\n        </header>\r\n\r\n        {/* Main Content */}\r\n        <main className=\"flex-1 overflow-y-auto no-scrollbar pb-32\">\r\n          {/* Time Filter */}\r\n          <section className=\"px-6 py-4\">\r\n            <div className=\"bg-slate-100 dark:bg-slate-800 p-1.5 rounded-full flex gap-1\">\r\n              <button className=\"flex-1 py-2 rounded-full text-sm font-medium text-slate-500\">Today</button>\r\n              <button className=\"flex-1 bg-white dark:bg-slate-700 py-2 rounded-full text-sm font-bold shadow-sm\">Week</button>\r\n              <button className=\"flex-1 py-2 rounded-full text-sm font-medium text-slate-500\">Month</button>\r\n            </div>\r\n          </section>\r\n\r\n          {/* Bar Chart Section */}\r\n          <section className=\"px-6 mt-4\">\r\n            <div className=\"bg-white dark:bg-slate-900 border border-slate-100 dark:border-slate-800 rounded-3xl p-6 shadow-sm\">\r\n              <div className=\"flex justify-between items-end mb-4\">\r\n                <div>\r\n                  <p className=\"text-xs font-bold text-slate-400 uppercase tracking-wider\">Avg. Intake</p>\r\n                  <h2 className=\"text-2xl font-extrabold\">{dailyAverage.toLocaleString()} <span className=\"text-sm font-bold text-slate-400\">kcal</span></h2>\r\n                </div>\r\n                <div className=\"flex gap-3 text-[10px] font-bold\">\r\n                  <div className=\"flex items-center gap-1\"><span className=\"w-2 h-2 rounded-full bg-[#8b93ff]\"></span> PRO</div>\r\n                  <div className=\"flex items-center gap-1\"><span className=\"w-2 h-2 rounded-full bg-[#7ee0b3]\"></span> CARB</div>\r\n                  <div className=\"flex items-center gap-1\"><span className=\"w-2 h-2 rounded-full bg-[#ffad84]\"></span> FAT</div>\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"h-48 flex items-end justify-between gap-2 pt-4\">\r\n                {weeklyData.map((dayData, idx) => (\r\n                  <div key={idx} className=\"flex-1 flex flex-col items-center gap-2 h-full justify-end group relative cursor-pointer\">\r\n                    {/* Tooltip on hover */}\r\n                    <div className=\"absolute -top-10 opacity-0 group-hover:opacity-100 transition-opacity bg-slate-900 dark:bg-slate-100 text-white dark:text-slate-900 text-[10px] font-bold py-1 px-2 rounded-lg pointer-events-none whitespace-nowrap z-50\">\r\n                      {dayData.rawCalories} kcal\r\n                    </div>\r\n                    \r\n                    <div className=\"w-full flex flex-col-reverse rounded-t-lg overflow-hidden transition-all duration-500 ease-out group-hover:opacity-80\" style={{ height: `${Math.max(2, dayData.total)}%` }}>\r\n                      <div className=\"bg-[#8b93ff]\" style={{ height: `${dayData.p}%` }}></div>\r\n                      <div className=\"bg-[#7ee0b3]\" style={{ height: `${dayData.c}%` }}></div>\r\n                      <div className=\"bg-[#ffad84]\" style={{ height: `${dayData.f}%` }}></div>\r\n                    </div>\r\n                    {/* Surligner le jour actuel (index 6 pour aujourd'hui avec 7 jours glissants, ou on peut le laisser tel quel) */}\r\n                    <span className={`text-[10px] font-bold ${dayData.rawCalories > 0 ? 'text-slate-900 dark:text-white' : 'text-slate-400'}`}>{dayData.day}</span>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </div>\r\n          </section>\r\n\r\n          {/* Analytics Cards */}\r\n          <section className=\"px-6 mt-8 grid grid-cols-2 gap-4\">\r\n            <div className=\"col-span-2 bg-orange-50 dark:bg-orange-950/20 rounded-3xl p-6 flex justify-between items-center transition-transform active:scale-[0.98]\">\r\n              <div>\r\n                <p className=\"text-xs font-bold text-orange-600 dark:text-orange-400 uppercase tracking-widest mb-1\">Total Calories</p>\r\n                <h3 className=\"text-3xl font-extrabold text-orange-900 dark:text-orange-100\">{totalWeeklyCalories.toLocaleString()}</h3>\r\n                <p className=\"text-xs text-orange-600/70 dark:text-orange-400/70 mt-1\">This Week</p>\r\n              </div>\r\n              <div className=\"w-16 h-16 bg-white dark:bg-orange-900/40 rounded-2xl flex items-center justify-center shadow-sm\">\r\n                <span className=\"material-symbols-rounded text-orange-500 text-3xl\">local_fire_department</span>\r\n              </div>\r\n            </div>\r\n            \r\n            <div className=\"bg-blue-50 dark:bg-blue-950/20 rounded-3xl p-5 flex flex-col justify-between aspect-square transition-transform active:scale-[0.98]\">\r\n              <div className=\"w-10 h-10 bg-white dark:bg-blue-900/40 rounded-xl flex items-center justify-center shadow-sm\">\r\n                <span className=\"material-symbols-rounded text-blue-500\">analytics</span>\r\n              </div>\r\n              <div>\r\n                <p className=\"text-[10px] font-bold text-blue-600 dark:text-blue-400 uppercase tracking-widest mb-0.5\">Daily Average</p>\r\n                <h3 className=\"text-xl font-extrabold text-blue-900 dark:text-blue-100\">{dailyAverage.toLocaleString()}</h3>\r\n                <div className=\"flex items-center gap-1 mt-1\">\r\n                  <span className=\"material-symbols-rounded text-xs text-slate-500 font-bold\">remove</span>\r\n                  <span className=\"text-[10px] font-bold text-slate-500\">0% vs last week</span>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            \r\n            <div className=\"bg-emerald-50 dark:bg-emerald-950/20 rounded-3xl p-5 flex flex-col justify-between aspect-square transition-transform active:scale-[0.98]\">\r\n              <div className=\"w-10 h-10 bg-white dark:bg-emerald-900/40 rounded-xl flex items-center justify-center shadow-sm\">\r\n                <span className=\"material-symbols-rounded text-emerald-500\">monitor_weight</span>\r\n              </div>\r\n              <div>\r\n                <p className=\"text-[10px] font-bold text-emerald-600 dark:text-emerald-400 uppercase tracking-widest mb-0.5\">Weight Trend</p>\r\n                <h3 className=\"text-xl font-extrabold text-emerald-900 dark:text-emerald-100\">{weightTrend ? weightTrend.latest : 0} kg</h3>\r\n                <p className=\"text-[10px] text-emerald-600/70 dark:text-emerald-400/70 mt-1\">\r\n                  {weightTrend && weightTrend.diff !== 0 \r\n                    ? `${weightTrend.diff > 0 ? '+' : ''}${weightTrend.diff} kg change`\r\n                    : 'No change recorded'}\r\n                </p>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Water Card */}\r\n            <div className=\"bg-cyan-50 dark:bg-cyan-950/20 rounded-3xl p-5 flex flex-col justify-between aspect-square transition-transform active:scale-[0.98]\">\r\n              <div className=\"w-10 h-10 bg-white dark:bg-cyan-900/40 rounded-xl flex items-center justify-center shadow-sm\">\r\n                <span className=\"material-symbols-rounded text-cyan-500\">water_drop</span>\r\n              </div>\r\n              <div>\r\n                <p className=\"text-[10px] font-bold text-cyan-600 dark:text-cyan-400 uppercase tracking-widest mb-0.5\">Hydration</p>\r\n                <h3 className=\"text-xl font-extrabold text-cyan-900 dark:text-cyan-100\">{waterToday} ml</h3>\r\n                <p className=\"text-[10px] text-cyan-600/70 dark:text-cyan-400/70 mt-1\">Today's Intake</p>\r\n              </div>\r\n            </div>\r\n\r\n            {/* BMI Card */}\r\n            <div className=\"bg-purple-50 dark:bg-purple-950/20 rounded-3xl p-5 flex flex-col justify-between aspect-square transition-transform active:scale-[0.98]\">\r\n              <div className=\"w-10 h-10 bg-white dark:bg-purple-900/40 rounded-xl flex items-center justify-center shadow-sm\">\r\n                <span className=\"material-symbols-rounded text-purple-500\">accessibility_new</span>\r\n              </div>\r\n              <div>\r\n                <p className=\"text-[10px] font-bold text-purple-600 dark:text-purple-400 uppercase tracking-widest mb-0.5\">BMI</p>\r\n                <h3 className=\"text-xl font-extrabold text-purple-900 dark:text-purple-100\">{bmi > 0 ? bmi : '--'}</h3>\r\n                <p className=\"text-[10px] text-purple-600/70 dark:text-purple-400/70 mt-1\">Current Ratio</p>\r\n              </div>\r\n            </div>\r\n          </section>\r\n        </main>\r\n\r\n        {/* Bottom Navigation */}\r\n        <nav className=\"absolute bottom-6 left-1/2 -translate-x-1/2 w-[90%] bg-slate-900/90 dark:bg-white/90 backdrop-blur-xl h-18 rounded-full flex items-center justify-around px-6 py-4 shadow-2xl z-50\">\r\n          <Link to=\"/\" className=\"flex flex-col items-center gap-1 text-slate-500\">\r\n            <span className=\"material-symbols-rounded\">home</span>\r\n          </Link>\r\n          <button className=\"flex flex-col items-center gap-1 text-slate-500\">\r\n            <span className=\"material-symbols-rounded\">camera_enhance</span>\r\n          </button>\r\n          <div className=\"relative -top-8\">\r\n            <Link to=\"/scanner\" className=\"w-16 h-16 bg-primary rounded-full flex items-center justify-center shadow-xl border-4 border-white dark:border-slate-900\">\r\n              <span className=\"material-symbols-rounded text-white text-3xl\">add</span>\r\n            </Link>\r\n          </div>\r\n          <button className=\"flex flex-col items-center gap-1 text-slate-500\">\r\n            <span className=\"material-symbols-rounded\">restaurant_menu</span>\r\n          </button>\r\n          <Link to=\"/stats\" className=\"flex flex-col items-center gap-1 text-white dark:text-slate-900\">\r\n            <span className=\"material-symbols-rounded fill-[1]\">bar_chart</span>\r\n          </Link>\r\n        </nav>\r\n        \r\n        <div className=\"absolute bottom-1.5 left-1/2 -translate-x-1/2 w-32 h-1.5 bg-slate-400/30 rounded-full z-50\"></div>\r\n      </div>\r\n    </motion.div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\pc\\.gemini\\antigravity\\scratch\\ai-calorie-app\\src\\pages\\Welcome.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":3,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[77,116],"text":""},"desc":"Remove unused variable 'motion'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { motion } from 'framer-motion';\r\n\r\nconst pageVariants = {\r\n  initial: { opacity: 0, scale: 0.98 },\r\n  animate: { opacity: 1, scale: 1, transition: { duration: 0.4, ease: 'easeOut' } },\r\n  exit: { opacity: 0, scale: 1.02, transition: { duration: 0.3 } },\r\n};\r\n\r\nexport default function Welcome() {\r\n  const navigate = useNavigate();\r\n\r\n  return (\r\n    <motion.div \r\n      variants={pageVariants}\r\n      initial=\"initial\"\r\n      animate=\"animate\"\r\n      exit=\"exit\"\r\n      className=\"text-slate-900 dark:text-slate-100 antialiased min-h-[max(884px,100dvh)] font-display\"\r\n    >\r\n      {/* Main Container */}\r\n      <div \r\n        className=\"relative flex min-h-screen w-full flex-col overflow-hidden\"\r\n        style={{\r\n          backgroundColor: '#f6f8f5', // background-light\r\n          background: 'radial-gradient(circle at 20% 30%, rgba(106, 244, 37, 0.08) 0%, transparent 50%), radial-gradient(circle at 80% 70%, rgba(106, 244, 37, 0.05) 0%, transparent 50%), #f6f8f5'\r\n        }}\r\n      >\r\n        <div className=\"dark:hidden opacity-0\" style={{ backgroundColor: '#162210' /* dummy to keep color */}}></div>\r\n        {/* For dark mode background, we need to handle it with classes, so we apply a standard dark class that overrides */}\r\n        <div className=\"absolute inset-0 pointer-events-none -z-20 bg-[#162210] hidden dark:block\"></div>\r\n        <div className=\"absolute inset-0 pointer-events-none -z-20 hidden dark:block\" style={{\r\n           background: 'radial-gradient(circle at 20% 30%, rgba(106, 244, 37, 0.08) 0%, transparent 50%), radial-gradient(circle at 80% 70%, rgba(106, 244, 37, 0.05) 0%, transparent 50%)'\r\n        }}></div>\r\n\r\n        {/* Hero Content Area */}\r\n        <div className=\"flex flex-1 flex-col items-center justify-center px-8 text-center @container\">\r\n          \r\n          {/* Logo Section */}\r\n          <div className=\"relative mb-12 flex h-48 w-48 items-center justify-center mt-8\">\r\n            {/* Decorative background glow */}\r\n            <div className=\"absolute inset-0 bg-[#6af425]/20 blur-3xl rounded-full\"></div>\r\n            \r\n            {/* Main Brand Mark */}\r\n            <div className=\"relative flex h-40 w-40 flex-col items-center justify-center rounded-xl border-2 border-[#6af425]/40 bg-[#162210]/80 p-4 backdrop-blur-md\">\r\n              {/* Camera Viewfinder Corners */}\r\n              <div className=\"absolute top-2 left-2 h-4 w-4 border-t-2 border-l-2 border-[#6af425]\"></div>\r\n              <div className=\"absolute top-2 right-2 h-4 w-4 border-t-2 border-r-2 border-[#6af425]\"></div>\r\n              <div className=\"absolute bottom-2 left-2 h-4 w-4 border-b-2 border-l-2 border-[#6af425]\"></div>\r\n              <div className=\"absolute bottom-2 right-2 h-4 w-4 border-b-2 border-r-2 border-[#6af425]\"></div>\r\n              \r\n              {/* The \"Orange Fruit\" Placeholder */}\r\n              <div className=\"relative h-24 w-24 overflow-hidden rounded-full shadow-lg shadow-[#6af425]/20\">\r\n                <img className=\"h-full w-full object-cover\" alt=\"A vibrant orange fruit captured in high definition\" src=\"https://lh3.googleusercontent.com/aida-public/AB6AXuAzMPBFTMKSNKKwxpDi8Ik_kqmOJDaVvWW2-vpY1YzXuGYApxds6FYnvfddTUBKxzEzP2SIJlOpmo3nS5CwoOXnuTprrDH-JFInA8g3fEmAwNG36JmHat4-xB1LuLontqo6BpFfBsWD0HGWXJWqPky6aEDphaeensgGOZrtExzdvtzjlLu8-H3UtjdcHRaQWnFe_RLNfnbN1dM-hAo3xuLcVNQxtDS7i6gY9f44h36H3ISOk6oSrtCk29eOO2d_rcuEAgceYt4WNM0w\"/>\r\n                <div className=\"absolute inset-0 bg-gradient-to-tr from-[#6af425]/20 to-transparent\"></div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          \r\n          {/* Text Content */}\r\n          <div className=\"space-y-4 max-w-sm relative z-10\">\r\n            <h1 style={{ fontFamily: \"'Space Grotesk', sans-serif\" }} className=\"text-4xl font-bold tracking-tight text-slate-900 dark:text-white sm:text-5xl\">\r\n              Welcome to <span className=\"text-[#6af425]\">Glymo AI</span>\r\n            </h1>\r\n            <p className=\"text-lg font-medium text-slate-600 dark:text-slate-400 leading-relaxed\">\r\n              Experience the future of nutrition with AI-powered calorie tracking. Your health, decoded.\r\n            </p>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Bottom Action Area */}\r\n        <div className=\"w-full px-6 pb-12 pt-6 relative z-10\">\r\n          <div className=\"mx-auto flex w-full max-w-md flex-col gap-4\">\r\n            {/* Primary CTA */}\r\n            <button \r\n              onClick={() => navigate('/onboarding/signup')}\r\n              className=\"group relative flex h-14 w-full items-center justify-center overflow-hidden rounded-full bg-[#6af425] font-display text-lg font-bold text-[#162210] transition-all active:scale-95\"\r\n            >\r\n              <span className=\"relative z-10 flex items-center gap-2\">\r\n                Get Started\r\n                <span className=\"material-symbols-rounded text-xl\">arrow_forward</span>\r\n              </span>\r\n              <div className=\"absolute inset-0 bg-white/20 opacity-0 group-hover:opacity-100 transition-opacity\"></div>\r\n            </button>\r\n            \r\n            {/* Secondary CTA */}\r\n            <button \r\n              onClick={() => navigate('/auth/signin')}\r\n              className=\"flex h-14 w-full items-center justify-center rounded-full border border-slate-300 dark:border-slate-700 font-display text-lg font-bold text-slate-900 dark:text-white backdrop-blur-sm transition-all active:scale-95 hover:bg-slate-100 dark:hover:bg-slate-800\"\r\n            >\r\n              Sign In\r\n            </button>\r\n            \r\n            {/* Terms/Privacy Subtle Text */}\r\n            <p className=\"mt-4 text-center text-xs text-slate-500 dark:text-slate-500\">\r\n              By continuing, you agree to our <a className=\"underline hover:text-[#6af425] transition-colors\" href=\"#\">Terms of Service</a> and <a className=\"underline hover:text-[#6af425] transition-colors\" href=\"#\">Privacy Policy</a>\r\n            </p>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Background Pattern/Overlay */}\r\n        <div className=\"absolute inset-0 z-0 h-full w-full pointer-events-none opacity-40\">\r\n          <div className=\"absolute inset-0 bg-[radial-gradient(ellipse_at_top_right,_var(--tw-gradient-stops))] from-[#6af425]/10 via-transparent to-transparent\"></div>\r\n        </div>\r\n      </div>\r\n    </motion.div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\pc\\.gemini\\antigravity\\scratch\\ai-calorie-app\\src\\pages\\onboarding\\AuthSignin.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":3,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[91,130],"text":""},"desc":"Remove unused variable 'motion'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { motion } from 'framer-motion';\r\nimport { supabase } from '../../lib/supabase';\r\n\r\nconst pageVariants = {\r\n  initial: { opacity: 0, scale: 0.98 },\r\n  animate: { opacity: 1, scale: 1, transition: { duration: 0.4, ease: 'easeOut' } },\r\n  exit: { opacity: 0, scale: 1.02, transition: { duration: 0.3 } },\r\n};\r\n\r\nexport default function AuthSignin() {\r\n  const navigate = useNavigate();\r\n  const [email, setEmail] = useState('');\r\n  const [password, setPassword] = useState('');\r\n  const [showPassword, setShowPassword] = useState(false);\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState(null);\r\n\r\n  const handleSignIn = async (e) => {\r\n    e.preventDefault();\r\n    setLoading(true);\r\n    setError(null);\r\n\r\n    const { data, error: signInError } = await supabase.auth.signInWithPassword({\r\n      email,\r\n      password,\r\n    });\r\n\r\n    if (signInError) {\r\n      setError(signInError.message);\r\n      setLoading(false);\r\n      return;\r\n    }\r\n\r\n    if (data?.session) {\r\n      // Upon successful sign in, assume onboarding is complete (can refine this logic later)\r\n      localStorage.setItem('onboarding_completed', 'true');\r\n      navigate('/');\r\n    }\r\n  };\r\n\r\n  return (\r\n    <motion.div\r\n      variants={pageVariants}\r\n      initial=\"initial\"\r\n      animate=\"animate\"\r\n      exit=\"exit\"\r\n      className=\"bg-[#f7f8f5] dark:bg-[#1a2210] font-display text-slate-900 dark:text-slate-100 min-h-screen selection:bg-[#9df425] selection:text-[#1a2210]\"\r\n    >\r\n      {/* Background Organic Shapes */}\r\n      <div \r\n        className=\"fixed inset-0 z-0 pointer-events-none\"\r\n        style={{\r\n          background: \"radial-gradient(circle at 10% 20%, rgba(157, 244, 37, 0.05) 0%, transparent 40%), radial-gradient(circle at 90% 80%, rgba(157, 244, 37, 0.08) 0%, transparent 40%)\"\r\n        }}\r\n      ></div>\r\n\r\n      <div className=\"relative z-10 flex flex-col min-h-screen max-w-[480px] mx-auto px-6 py-8\">\r\n        {/* Top App Bar / Logo Section */}\r\n        <header className=\"flex flex-col items-center pt-12 pb-10\">\r\n          <div className=\"bg-[#9df425]/10 p-4 rounded-full mb-6 border border-[#9df425]/20\">\r\n            <div className=\"text-[#9df425] flex size-12 items-center justify-center\">\r\n              <span className=\"material-symbols-rounded text-4xl leading-none\">nutrition</span>\r\n            </div>\r\n          </div>\r\n          <h2 className=\"text-[#9df425] text-xl font-bold tracking-tight uppercase\">Glymo AI</h2>\r\n        </header>\r\n\r\n        {/* Welcome Text */}\r\n        <div className=\"mb-10 text-center\">\r\n          <h1 className=\"text-slate-900 dark:text-slate-100 text-4xl font-bold leading-tight mb-2\">Welcome Back!</h1>\r\n          <p className=\"text-slate-500 dark:text-slate-400 text-base\">Sign in to track your nutrition journey</p>\r\n        </div>\r\n\r\n        {/* Login Form */}\r\n        <form className=\"flex flex-col gap-5\" onSubmit={handleSignIn}>\r\n          <div className=\"flex flex-col gap-2\">\r\n            <label className=\"text-sm font-medium px-1 text-slate-700 dark:text-slate-300\">Email Address</label>\r\n            <div className=\"rounded-xl flex items-center px-4 transition-all focus-within:ring-1 focus-within:ring-[#9df425]/50 focus-within:border-[#9df425]/50\"\r\n                 style={{\r\n                   background: \"rgba(255, 255, 255, 0.03)\",\r\n                   backdropFilter: \"blur(12px)\",\r\n                   border: \"1px solid rgba(157, 244, 37, 0.1)\"\r\n                 }}\r\n            >\r\n              <span className=\"material-symbols-rounded text-slate-400 text-xl mr-3\">mail</span>\r\n              <input \r\n                className=\"w-full bg-transparent border-none focus:ring-0 text-slate-900 dark:text-slate-100 h-14 placeholder:text-slate-500 py-4 text-base outline-none\" \r\n                placeholder=\"name@example.com\" \r\n                type=\"email\"\r\n                value={email}\r\n                onChange={(e) => setEmail(e.target.value)}\r\n                required\r\n              />\r\n            </div>\r\n          </div>\r\n          <div className=\"flex flex-col gap-2\">\r\n            <label className=\"text-sm font-medium px-1 text-slate-700 dark:text-slate-300\">Password</label>\r\n            <div className=\"rounded-xl flex items-center px-4 transition-all focus-within:ring-1 focus-within:ring-[#9df425]/50 focus-within:border-[#9df425]/50\"\r\n                 style={{\r\n                   background: \"rgba(255, 255, 255, 0.03)\",\r\n                   backdropFilter: \"blur(12px)\",\r\n                   border: \"1px solid rgba(157, 244, 37, 0.1)\"\r\n                 }}\r\n            >\r\n              <span className=\"material-symbols-rounded text-slate-400 text-xl mr-3\">lock</span>\r\n              <input \r\n                className=\"w-full bg-transparent border-none focus:ring-0 text-slate-900 dark:text-slate-100 h-14 placeholder:text-slate-500 py-4 text-base outline-none\" \r\n                placeholder=\"••••••••\" \r\n                type={showPassword ? \"text\" : \"password\"}\r\n                value={password}\r\n                onChange={(e) => setPassword(e.target.value)}\r\n                required\r\n              />\r\n              <button \r\n                className=\"text-slate-400 hover:text-[#9df425] transition-colors h-full flex items-center\" \r\n                type=\"button\"\r\n                onClick={() => setShowPassword(!showPassword)}\r\n              >\r\n                <span className=\"material-symbols-rounded text-xl leading-none\">{showPassword ? \"visibility_off\" : \"visibility\"}</span>\r\n              </button>\r\n            </div>\r\n          </div>\r\n          \r\n          <div className=\"flex justify-between pt-1\">\r\n             <button\r\n               type=\"button\"\r\n               onClick={() => navigate('/welcome')}\r\n               className=\"text-slate-500 hover:text-slate-700 dark:hover:text-slate-300 text-sm font-medium flex items-center gap-1\"\r\n             >\r\n               <span className=\"material-symbols-rounded text-[18px]\">arrow_back</span> Back\r\n             </button>\r\n            <a className=\"text-[#9df425] text-sm font-medium hover:underline underline-offset-4\" href=\"#\">Forgot Password?</a>\r\n          </div>\r\n\r\n          {error && (\r\n            <div className=\"bg-red-500/10 border border-red-500/20 text-red-500 p-3 rounded-lg text-sm text-center\">\r\n              {error}\r\n            </div>\r\n          )}\r\n\r\n          <button \r\n            type=\"submit\"\r\n            disabled={loading}\r\n            className=\"bg-[#9df425] text-[#1a2210] font-bold text-lg h-14 rounded-full mt-4 shadow-lg shadow-[#9df425]/20 active:scale-[0.98] transition-all flex items-center justify-center gap-2 hover:bg-[#aef542] disabled:opacity-50\"\r\n          >\r\n            {loading ? \"Signing In...\" : \"Sign In\"}\r\n            {!loading && <span className=\"material-symbols-rounded\">arrow_forward</span>}\r\n          </button>\r\n        </form>\r\n\r\n        {/* Divider */}\r\n        <div className=\"flex items-center gap-4 my-10\">\r\n          <div className=\"h-[1px] flex-1 bg-slate-200 dark:bg-[#9df425]/10\"></div>\r\n          <span className=\"text-slate-400 text-xs font-bold uppercase tracking-widest\">Or continue with</span>\r\n          <div className=\"h-[1px] flex-1 bg-slate-200 dark:bg-[#9df425]/10\"></div>\r\n        </div>\r\n\r\n        {/* Social Logins */}\r\n        <div className=\"grid grid-cols-2 gap-4 mb-10\">\r\n          <button className=\"h-14 rounded-full flex items-center justify-center gap-3 hover:bg-white/5 transition-colors border border-[#9df425]/10\" style={{ background: \"rgba(255, 255, 255, 0.03)\" }}>\r\n            <img alt=\"Google Logo\" className=\"w-5 h-5 grayscale brightness-200 contrast-200\" src=\"https://lh3.googleusercontent.com/aida-public/AB6AXuBdJR6epMRAJH3jpdZ7Qn63n26h0u1EqmX46-S91pjWjKpCOIsxRLCBcQ3bS1lAUBIIAJkWOKcKqJbvnDAKTabMNIZNRTGmAaqr6Tl5_rNdoxWMfmeDpghk4j1o9Zb5hUMGQwz1etEFq4rQxEv37QDY2G9DXdyjjiUulOjxyyIJZee1qpaVjxw2Tl6ZV90uP6oIZrUj6g2-9VKPPKsq3g3nzmGThrgjo83G87WJNrc1mI1Du8HCKy4pxaFQsvJSjOVXXuW3qfcmC2lN\"/>\r\n            <span className=\"text-sm font-semibold\">Google</span>\r\n          </button>\r\n          <button className=\"h-14 rounded-full flex items-center justify-center gap-3 hover:bg-white/5 transition-colors border border-[#9df425]/10\" style={{ background: \"rgba(255, 255, 255, 0.03)\" }}>\r\n            <span className=\"material-symbols-rounded text-xl\">apple</span>\r\n            <span className=\"text-sm font-semibold\">Apple</span>\r\n          </button>\r\n        </div>\r\n\r\n        {/* Footer */}\r\n        <footer className=\"mt-auto text-center py-6\">\r\n          <p className=\"text-slate-500 dark:text-slate-400 text-sm\">\r\n            Don't have an account? \r\n            <button onClick={() => navigate('/onboarding/signup')} className=\"text-[#9df425] font-bold hover:underline underline-offset-4 ml-1\">Create an account</button>\r\n          </p>\r\n        </footer>\r\n      </div>\r\n    </motion.div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\pc\\.gemini\\antigravity\\scratch\\ai-calorie-app\\src\\pages\\onboarding\\AuthSignup.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":3,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[100,107],"text":""},"desc":"Remove unused variable 'motion'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'data' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":161,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":161,"endColumn":19,"suggestions":[{"messageId":"removeVar","data":{"varName":"data"},"fix":{"range":[5544,5549],"text":""},"desc":"Remove unused variable 'data'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport { useLanguage } from '../../context/LanguageContext';\r\nimport { supabase } from '../../lib/supabase';\r\n\r\nconst slideVariants = {\r\n  enter: (direction) => ({\r\n    x: direction > 0 ? 50 : -50,\r\n    opacity: 0\r\n  }),\r\n  center: {\r\n    x: 0,\r\n    opacity: 1,\r\n    transition: { duration: 0.3, ease: 'easeOut' }\r\n  },\r\n  exit: (direction) => ({\r\n    x: direction < 0 ? 50 : -50,\r\n    opacity: 0,\r\n    transition: { duration: 0.2, ease: 'easeIn' }\r\n  })\r\n};\r\n\r\nexport default function AuthSignup() {\r\n  const navigate = useNavigate();\r\n  const { lang, toggleLanguage } = useLanguage();\r\n  \r\n  const [step, setStep] = useState(1);\r\n  const [direction, setDirection] = useState(1); // 1 = forward, -1 = backward\r\n  \r\n  const [name, setName] = useState('');\r\n  const [email, setEmail] = useState('');\r\n  const [password, setPassword] = useState('');\r\n  \r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState(null);\r\n\r\n  const content = {\r\n    EN: {\r\n      appName: \"Onboarding\",\r\n      step1Title: \"What's your\",\r\n      step1Highlight: \"name?\",\r\n      step1Desc: \"We'll use this to personalize your calorie tracking and nutrition journey.\",\r\n      step1Label: \"Full Name\",\r\n      step1Placeholder: \"Enter your full name\",\r\n      step1Tip: \"Your name helps our AI assistant address you properly during your daily check-ins.\",\r\n      \r\n      step2Title: \"What's your\",\r\n      step2Highlight: \"email?\",\r\n      step2Desc: \"We need this to securely save your progress and send weekly insights.\",\r\n      step2Label: \"Email Address\",\r\n      step2Placeholder: \"you@example.com\",\r\n      step2Tip: \"We respect your privacy and will never spam your inbox.\",\r\n      \r\n      step3Title: \"Create your\",\r\n      step3Highlight: \"password\",\r\n      step3Desc: \"Choose a strong password to keep your nutrition and photo data secure.\",\r\n      step3Label: \"Password\",\r\n      step3Placeholder: \"At least 6 characters\",\r\n      pwdStrength: \"Password Strength\",\r\n      pwdGood: \"Good\",\r\n      pwdRule1: \"At least 6 characters\",\r\n      pwdEncrypted: \"Your password is encrypted and never shared.\",\r\n      \r\n      continue: \"Continue\",\r\n      creating: \"Creating account...\",\r\n      loginLink: \"Login\"\r\n    },\r\n    FR: {\r\n      appName: \"Intégration\",\r\n      step1Title: \"Quel est votre\",\r\n      step1Highlight: \"nom ?\",\r\n      step1Desc: \"Nous l'utiliserons pour personnaliser votre suivi calorique.\",\r\n      step1Label: \"Nom Complet\",\r\n      step1Placeholder: \"Entrez votre nom complet\",\r\n      step1Tip: \"Votre nom aide notre assistant IA à s'adresser correctement à vous.\",\r\n      \r\n      step2Title: \"Quel est votre\",\r\n      step2Highlight: \"email ?\",\r\n      step2Desc: \"Nécessaire pour sauvegarder vos progrès en toute sécurité.\",\r\n      step2Label: \"Adresse Email\",\r\n      step2Placeholder: \"vous@exemple.com\",\r\n      step2Tip: \"Nous respectons votre vie privée et ne vous enverrons pas de spam.\",\r\n      \r\n      step3Title: \"Créez votre\",\r\n      step3Highlight: \"mot de passe\",\r\n      step3Desc: \"Choisissez un mot de passe fort pour protéger vos données.\",\r\n      step3Label: \"Mot de passe\",\r\n      step3Placeholder: \"Au moins 6 caractères\",\r\n      pwdStrength: \"Force du mot de passe\",\r\n      pwdGood: \"Bon\",\r\n      pwdRule1: \"Au moins 6 caractères\",\r\n      pwdEncrypted: \"Votre mot de passe est crypté et n'est jamais partagé.\",\r\n      \r\n      continue: \"Continuer\",\r\n      creating: \"Création en cours...\",\r\n      loginLink: \"Connexion\"\r\n    },\r\n    ES: {\r\n      appName: \"Registro\",\r\n      step1Title: \"¿Cuál es tu\",\r\n      step1Highlight: \"nombre?\",\r\n      step1Desc: \"Lo usaremos para personalizar tu seguimiento calórico.\",\r\n      step1Label: \"Nombre Completo\",\r\n      step1Placeholder: \"Ingresa tu nombre completo\",\r\n      step1Tip: \"Tu nombre ayuda a nuestro asistente de IA a dirigirse a ti correctamente.\",\r\n      \r\n      step2Title: \"¿Cuál es tu\",\r\n      step2Highlight: \"correo?\",\r\n      step2Desc: \"Lo necesitamos para guardar tu progreso de forma segura.\",\r\n      step2Label: \"Correo Electrónico\",\r\n      step2Placeholder: \"tu@ejemplo.com\",\r\n      step2Tip: \"Respetamos tu privacidad y nunca enviaremos spam.\",\r\n      \r\n      step3Title: \"Crea tu\",\r\n      step3Highlight: \"contraseña\",\r\n      step3Desc: \"Elige una contraseña segura para proteger tus datos.\",\r\n      step3Label: \"Contraseña\",\r\n      step3Placeholder: \"Al menos 6 caracteres\",\r\n      pwdStrength: \"Fuerza de la contraseña\",\r\n      pwdGood: \"Buena\",\r\n      pwdRule1: \"Al menos 6 caracteres\",\r\n      pwdEncrypted: \"Tu contraseña está encriptada y nunca se comparte.\",\r\n      \r\n      continue: \"Continuar\",\r\n      creating: \"Creando cuenta...\",\r\n      loginLink: \"Iniciar sesión\"\r\n    }\r\n  };\r\n\r\n  const currentContent = content[lang] || content['EN'];\r\n  const progressPercent = step === 1 ? 25 : step === 2 ? 50 : 75;\r\n\r\n  const handleNext = (e) => {\r\n    e.preventDefault();\r\n    if (step === 1 && name.trim()) {\r\n      setDirection(1);\r\n      setStep(2);\r\n    } else if (step === 2 && email.trim()) {\r\n      setDirection(1);\r\n      setStep(3);\r\n    } else if (step === 3 && password.length >= 6) {\r\n      handleSubmit();\r\n    }\r\n  };\r\n\r\n  const handleBack = () => {\r\n    if (step > 1) {\r\n      setDirection(-1);\r\n      setStep(step - 1);\r\n    } else {\r\n      navigate(-1);\r\n    }\r\n  };\r\n\r\n  const handleSubmit = async () => {\r\n    setLoading(true);\r\n    setError(null);\r\n\r\n    try {\r\n      const { data, error: authError } = await supabase.auth.signUp({\r\n        email,\r\n        password,\r\n        options: {\r\n          data: {\r\n            full_name: name,\r\n          }\r\n        }\r\n      });\r\n\r\n      if (authError) throw authError;\r\n\r\n      localStorage.setItem('user_name', name);\r\n      localStorage.setItem('auth_email', email);\r\n      \r\n      navigate('/onboarding/source');\r\n    } catch (err) {\r\n      console.error('Error during signup:', err);\r\n      setError(err.message || \"An error occurred during registration.\");\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"bg-background-light dark:bg-background-dark font-display text-slate-900 dark:text-slate-100 min-h-screen flex justify-center pb-24 lg:pb-0\">\r\n      <div className=\"relative flex flex-col min-h-screen w-full max-w-[430px] mx-auto overflow-hidden bg-white dark:bg-slate-900 shadow-2xl\">\r\n        \r\n        {/* Decorative background elements */}\r\n        <div className=\"fixed -top-24 -right-24 size-96 bg-green-500/5 rounded-full blur-3xl pointer-events-none -z-10\"></div>\r\n        <div className=\"fixed top-1/2 -left-24 size-64 bg-green-500/10 rounded-full blur-3xl pointer-events-none -z-10\"></div>\r\n\r\n        {/* Top Navigation Bar */}\r\n        <nav className=\"flex items-center justify-between px-6 pt-12 pb-4 bg-transparent z-10 shrink-0\">\r\n          <button \r\n            type=\"button\"\r\n            onClick={handleBack} \r\n            className=\"w-10 h-10 flex items-center justify-center rounded-full bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-300 hover:bg-slate-200 transition-colors\"\r\n          >\r\n            <span className=\"material-symbols-rounded\">chevron_left</span>\r\n          </button>\r\n          \r\n          <div className=\"flex flex-col items-center\">\r\n            <span className=\"text-xs font-bold uppercase tracking-widest text-green-500/80 mb-0.5\">{currentContent.appName}</span>\r\n            <span className=\"text-sm font-semibold\">Step {step} of 4</span>\r\n          </div>\r\n\r\n          <button \r\n            type=\"button\"\r\n            onClick={toggleLanguage}\r\n            className=\"h-10 px-3 bg-slate-100 dark:bg-slate-800 rounded-full flex items-center gap-1.5 active:scale-95 transition-transform\"\r\n          >\r\n            <span className=\"material-symbols-rounded text-[18px]\">language</span>\r\n            <span className=\"text-xs font-bold tracking-wider\">{lang}</span>\r\n          </button>\r\n        </nav>\r\n\r\n        {/* Progress Indicator */}\r\n        <div className=\"px-6 mt-2 shrink-0 z-10\">\r\n          <div className=\"w-full h-1.5 bg-green-500/10 dark:bg-slate-800 rounded-full overflow-hidden\">\r\n            <div \r\n              className=\"h-full bg-green-500 rounded-full transition-all duration-500 ease-out\" \r\n              style={{ width: `${progressPercent}%` }}\r\n            ></div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Active Step Content */}\r\n        <div className=\"flex-1 relative z-10 overflow-x-hidden\">\r\n          <AnimatePresence custom={direction} mode=\"wait\">\r\n            <motion.div\r\n              key={step}\r\n              custom={direction}\r\n              variants={slideVariants}\r\n              initial=\"enter\"\r\n              animate=\"center\"\r\n              exit=\"exit\"\r\n              className=\"absolute inset-0 px-8 pt-10\"\r\n            >\r\n              <form onSubmit={handleNext} className=\"h-full flex flex-col\">\r\n                \r\n                {/* Headers per step */}\r\n                <header className=\"mb-10\">\r\n                  {step === 3 && (\r\n                    <div className=\"inline-flex items-center justify-center w-16 h-16 rounded-full bg-green-500/10 mb-6 border border-green-500/20 shadow-sm\">\r\n                      <span className=\"material-symbols-rounded text-green-500 text-3xl\">lock</span>\r\n                    </div>\r\n                  )}\r\n\r\n                  <h1 className=\"text-4xl font-extrabold tracking-tight text-slate-900 dark:text-white mb-4\">\r\n                    {step === 1 && <>{currentContent.step1Title} <span className=\"text-green-500\">{currentContent.step1Highlight}</span></>}\r\n                    {step === 2 && <>{currentContent.step2Title} <span className=\"text-green-500\">{currentContent.step2Highlight}</span></>}\r\n                    {step === 3 && <>{currentContent.step3Title} <span className=\"text-green-500\">{currentContent.step3Highlight}</span></>}\r\n                  </h1>\r\n                  \r\n                  <p className=\"text-lg text-slate-500 dark:text-slate-400 leading-relaxed\">\r\n                    {step === 1 && currentContent.step1Desc}\r\n                    {step === 2 && currentContent.step2Desc}\r\n                    {step === 3 && currentContent.step3Desc}\r\n                  </p>\r\n                </header>\r\n\r\n                {/* Inputs per step */}\r\n                <div className=\"space-y-6\">\r\n                  {step === 1 && (\r\n                    <div className=\"space-y-4\">\r\n                      <label className=\"block text-sm font-bold text-slate-700 dark:text-slate-300 ml-1\">\r\n                        {currentContent.step1Label}\r\n                      </label>\r\n                      <div className=\"relative group\">\r\n                        <input \r\n                          autoFocus\r\n                          type=\"text\"\r\n                          value={name}\r\n                          onChange={(e) => setName(e.target.value)}\r\n                          placeholder={currentContent.step1Placeholder}\r\n                          required\r\n                          className=\"w-full h-16 pl-6 pr-14 rounded-2xl border border-slate-200 dark:border-slate-800 bg-slate-50 dark:bg-slate-900 focus:ring-4 focus:ring-green-500/10 focus:border-green-500 focus:bg-white dark:focus:bg-slate-800 transition-all duration-300 text-lg font-bold shadow-[0_4px_24px_-1px_rgba(19,236,19,0.08)] outline-none\" \r\n                        />\r\n                        <div className=\"absolute right-5 top-1/2 -translate-y-1/2 text-slate-300 dark:text-slate-600\">\r\n                          <span className=\"material-symbols-rounded text-2xl\">person</span>\r\n                        </div>\r\n                      </div>\r\n                      <div className=\"flex items-start gap-3 p-4 rounded-2xl bg-green-500/5 border border-green-500/10 mt-6\">\r\n                        <span className=\"material-symbols-rounded text-green-500 text-xl shrink-0 mt-0.5\">info</span>\r\n                        <p className=\"text-sm text-slate-600 dark:text-slate-400 leading-snug font-medium\">\r\n                          {currentContent.step1Tip}\r\n                        </p>\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n\r\n                  {step === 2 && (\r\n                    <div className=\"space-y-4\">\r\n                      <label className=\"block text-sm font-bold text-slate-700 dark:text-slate-300 ml-1\">\r\n                        {currentContent.step2Label}\r\n                      </label>\r\n                      <div className=\"relative group\">\r\n                        <input \r\n                          autoFocus\r\n                          type=\"email\"\r\n                          value={email}\r\n                          onChange={(e) => setEmail(e.target.value)}\r\n                          placeholder={currentContent.step2Placeholder}\r\n                          required\r\n                          className=\"w-full h-16 pl-6 pr-14 rounded-2xl border border-slate-200 dark:border-slate-800 bg-slate-50 dark:bg-slate-900 focus:ring-4 focus:ring-green-500/10 focus:border-green-500 focus:bg-white dark:focus:bg-slate-800 transition-all duration-300 text-lg font-bold shadow-[0_4px_24px_-1px_rgba(19,236,19,0.08)] outline-none\" \r\n                        />\r\n                        <div className=\"absolute right-5 top-1/2 -translate-y-1/2 text-slate-300 dark:text-slate-600\">\r\n                          <span className=\"material-symbols-rounded text-2xl\">mail</span>\r\n                        </div>\r\n                      </div>\r\n                      <div className=\"flex items-start gap-3 p-4 rounded-2xl bg-green-500/5 border border-green-500/10 mt-6\">\r\n                        <span className=\"material-symbols-rounded text-green-500 text-xl shrink-0 mt-0.5\">verified_user</span>\r\n                        <p className=\"text-sm text-slate-600 dark:text-slate-400 leading-snug font-medium\">\r\n                          {currentContent.step2Tip}\r\n                        </p>\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n\r\n                  {step === 3 && (\r\n                    <div className=\"space-y-5\">\r\n                      <label className=\"block text-sm font-bold text-slate-700 dark:text-slate-300 ml-1\">\r\n                        {currentContent.step3Label}\r\n                      </label>\r\n                      <div className=\"relative group\">\r\n                        <input \r\n                          autoFocus\r\n                          type=\"password\"\r\n                          value={password}\r\n                          onChange={(e) => setPassword(e.target.value)}\r\n                          placeholder={currentContent.step3Placeholder}\r\n                          required\r\n                          minLength={6}\r\n                          className=\"w-full h-16 pl-6 pr-14 rounded-2xl border border-slate-200 dark:border-slate-800 bg-slate-50 dark:bg-slate-900 focus:ring-4 focus:ring-green-500/10 focus:border-green-500 focus:bg-white dark:focus:bg-slate-800 transition-all duration-300 text-lg font-bold shadow-[0_4px_24px_-1px_rgba(19,236,19,0.08)] outline-none tracking-widest\" \r\n                        />\r\n                      </div>\r\n\r\n                      <div className=\"space-y-3 p-5 rounded-2xl bg-slate-50 dark:bg-slate-800/30 border border-slate-100 dark:border-slate-800\">\r\n                        <div className=\"flex items-center justify-between mb-1\">\r\n                          <span className=\"text-sm font-bold text-slate-600 dark:text-slate-400\">{currentContent.pwdStrength}</span>\r\n                          <span className={`text-sm font-extrabold ${password.length >= 6 ? 'text-green-500' : 'text-slate-400'}`}>\r\n                            {password.length >= 6 ? currentContent.pwdGood : ''}\r\n                          </span>\r\n                        </div>\r\n                        <div className=\"flex gap-1.5 h-2\">\r\n                          <div className={`flex-1 rounded-full transition-colors duration-500 ${password.length > 0 ? 'bg-green-500' : 'bg-slate-200 dark:bg-slate-700'}`}></div>\r\n                          <div className={`flex-1 rounded-full transition-colors duration-500 ${password.length >= 3 ? 'bg-green-500' : 'bg-slate-200 dark:bg-slate-700'}`}></div>\r\n                          <div className={`flex-1 rounded-full transition-colors duration-500 ${password.length >= 6 ? 'bg-green-500' : 'bg-slate-200 dark:bg-slate-700'}`}></div>\r\n                        </div>\r\n                        \r\n                        <div className=\"pt-3\">\r\n                          <div className={`flex items-center gap-3 transition-opacity ${password.length >= 6 ? 'opacity-100' : 'opacity-50'}`}>\r\n                            <div className={`flex-shrink-0 w-6 h-6 rounded-full flex items-center justify-center transition-colors ${password.length >= 6 ? 'bg-green-500/20 text-green-600 dark:text-green-400' : 'bg-slate-200 dark:bg-slate-700 text-transparent'}`}>\r\n                              {password.length >= 6 && <span className=\"material-symbols-rounded text-sm font-bold\">check</span>}\r\n                            </div>\r\n                            <span className={`text-sm font-bold ${password.length >= 6 ? 'text-green-600 dark:text-green-400' : 'text-slate-600 dark:text-slate-400'}`}>\r\n                              {currentContent.pwdRule1}\r\n                            </span>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n\r\n                      {error && (\r\n                        <div className=\"bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-400 text-sm p-4 rounded-xl border border-red-100 dark:border-red-900/30 flex items-start gap-3 mt-4 font-medium\">\r\n                          <span className=\"material-symbols-rounded text-lg shrink-0 mt-0.5\">error</span>\r\n                          <p>{error}</p>\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  )}\r\n                </div>\r\n\r\n                {/* Dummy submit button strictly to allow form submission on \"Enter\" */}\r\n                <button type=\"submit\" className=\"hidden\"></button>\r\n              </form>\r\n            </motion.div>\r\n          </AnimatePresence>\r\n        </div>\r\n\r\n        {/* Fixed Bottom Action */}\r\n        <div className=\"absolute bottom-0 w-full p-8 pb-10 bg-gradient-to-t from-white dark:from-slate-900 via-white dark:via-slate-900 to-transparent z-20\">\r\n          <button \r\n            onClick={handleNext}\r\n            disabled={loading || (step === 3 && password.length < 6)}\r\n            className={`w-full h-16 rounded-[1.25rem] font-extrabold text-lg flex items-center justify-center gap-2 transition-all ${\r\n              loading \r\n                ? 'bg-green-400 text-white shadow-none cursor-not-allowed' \r\n                : 'bg-green-500 hover:bg-green-600 text-white shadow-xl shadow-green-500/30 active:scale-[0.98]'\r\n            } ${step === 3 && password.length < 6 ? 'opacity-50 cursor-not-allowed shadow-none' : ''}`}\r\n          >\r\n            {loading ? (\r\n              <>\r\n                <span className=\"material-symbols-rounded animate-spin\">progress_activity</span>\r\n                <span>{currentContent.creating}</span>\r\n              </>\r\n            ) : (\r\n              <>\r\n                <span>{currentContent.continue}</span>\r\n                <span className=\"material-symbols-rounded\">arrow_forward</span>\r\n              </>\r\n            )}\r\n          </button>\r\n          \r\n          {step === 3 && (\r\n            <p className=\"text-center mt-6 text-xs font-semibold text-slate-400 dark:text-slate-500 flex justify-center items-center gap-1.5\">\r\n              <span className=\"material-symbols-rounded text-sm\">lock</span>\r\n              {currentContent.pwdEncrypted}\r\n            </p>\r\n          )}\r\n        </div>\r\n        \r\n        {/* iOS Indicator */}\r\n        <div className=\"absolute bottom-2 left-1/2 -translate-x-1/2 w-32 h-1.5 bg-slate-300 dark:bg-slate-700 rounded-full z-50\"></div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\pc\\.gemini\\antigravity\\scratch\\ai-calorie-app\\src\\pages\\onboarding\\DiscoverySource.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":3,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[91,130],"text":""},"desc":"Remove unused variable 'motion'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { motion } from 'framer-motion';\r\nimport { useLanguage } from '../../context/LanguageContext';\r\n\r\nconst pageVariants = {\r\n  initial: { opacity: 0, x: 50 },\r\n  animate: { opacity: 1, x: 0, transition: { duration: 0.4 } },\r\n  exit: { opacity: 0, x: -50, transition: { duration: 0.3 } },\r\n};\r\n\r\nexport default function DiscoverySource() {\r\n  const navigate = useNavigate();\r\n  const [selectedSource, setSelectedSource] = useState(null);\r\n  const { lang, toggleLanguage } = useLanguage();\r\n\r\n  const content = {\r\n    EN: {\r\n      step: \"Step 2 of 4\",\r\n      title: \"Discovery Source\",\r\n      description: \"Help us understand how you reached our AI nutrition community.\",\r\n      nextBtn: \"Next Step\",\r\n      sources: [\r\n        { id: 'social', icon: 'share', title: 'Social Media', desc: 'Instagram, TikTok, or others' },\r\n        { id: 'friends', icon: 'group', title: 'Friends/Family', desc: 'Recommended by someone' },\r\n        { id: 'store', icon: 'store', title: 'App Store', desc: 'Search or featured' },\r\n        { id: 'other', icon: 'more_horiz', title: 'Other', desc: 'None of the above' },\r\n      ]\r\n    },\r\n    FR: {\r\n      step: \"Étape 2 sur 4\",\r\n      title: \"Source de découverte\",\r\n      description: \"Aidez-nous à comprendre comment vous avez connu notre application.\",\r\n      nextBtn: \"Étape suivante\",\r\n      sources: [\r\n        { id: 'social', icon: 'share', title: 'Réseaux Sociaux', desc: 'Instagram, TikTok, ou autres' },\r\n        { id: 'friends', icon: 'group', title: 'Amis/Famille', desc: 'Recommandé par un proche' },\r\n        { id: 'store', icon: 'store', title: 'App Store', desc: 'Recherche ou mise en avant' },\r\n        { id: 'other', icon: 'more_horiz', title: 'Autre', desc: 'Aucune de ces réponses' },\r\n      ]\r\n    },\r\n    ES: {\r\n      step: \"Paso 2 de 4\",\r\n      title: \"Fuente de descubrimiento\",\r\n      description: \"Ayúdanos a entender cómo nos conociste.\",\r\n      nextBtn: \"Siguiente paso\",\r\n      sources: [\r\n        { id: 'social', icon: 'share', title: 'Redes Sociales', desc: 'Instagram, TikTok, u otras' },\r\n        { id: 'friends', icon: 'group', title: 'Amigos/Familia', desc: 'Recomendado por alguien' },\r\n        { id: 'store', icon: 'store', title: 'App Store', desc: 'Búsqueda o destacado' },\r\n        { id: 'other', icon: 'more_horiz', title: 'Otro', desc: 'Ninguna de las opciones' },\r\n      ]\r\n    }\r\n  };\r\n\r\n  const currentContent = content[lang] || content['EN'];\r\n\r\n  const handleNext = () => {\r\n    if (selectedSource) {\r\n      localStorage.setItem('onboarding_source', selectedSource);\r\n    }\r\n    navigate('/onboarding/goal');\r\n  };\r\n\r\n  return (\r\n    <motion.div \r\n      className=\"bg-background-light dark:bg-background-dark font-display text-slate-900 dark:text-slate-100 min-h-screen flex justify-center\"\r\n      variants={pageVariants}\r\n      initial=\"initial\"\r\n      animate=\"animate\"\r\n      exit=\"exit\"\r\n    >\r\n      <div className=\"w-full max-w-md bg-white dark:bg-slate-900 min-h-screen shadow-2xl relative overflow-hidden flex flex-col\">\r\n\r\n        {/* Progress Header */}\r\n        <div className=\"px-6 pt-10 pb-2 z-10\">\r\n          <div className=\"flex justify-between items-center mb-3\">\r\n            <button className=\"w-10 h-10 flex items-center justify-start text-slate-900 dark:text-slate-100 opacity-50 cursor-not-allowed\">\r\n              <span className=\"material-symbols-rounded\">arrow_back_ios_new</span>\r\n            </button>\r\n            <span className=\"text-sm font-semibold text-slate-500\">{currentContent.step}</span>\r\n            <button \r\n              onClick={toggleLanguage}\r\n              className=\"h-10 px-3 bg-slate-100 dark:bg-slate-800 rounded-full flex items-center gap-1.5 active:scale-95 transition-transform\"\r\n            >\r\n              <span className=\"material-symbols-rounded text-[18px]\">language</span>\r\n              <span className=\"text-xs font-bold tracking-wider\">{lang}</span>\r\n            </button>\r\n          </div>\r\n          {/* Progress Bar */}\r\n          <div className=\"w-full h-1.5 bg-green-500/10 dark:bg-green-400/10 rounded-full overflow-hidden\">\r\n            <div className=\"h-full bg-green-500 dark:bg-green-400 rounded-full transition-all duration-500\" style={{ width: '50%' }}></div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Main Content */}\r\n        <main className=\"flex-1 overflow-y-auto px-6 pt-8 pb-32 no-scrollbar z-10\">\r\n          <h1 className=\"text-3xl font-extrabold leading-tight mb-3\">\r\n            {currentContent.title}\r\n          </h1>\r\n          <p className=\"text-slate-500 dark:text-slate-400 text-lg leading-relaxed mb-10\">\r\n            {currentContent.description}\r\n          </p>\r\n\r\n          {/* Options List */}\r\n          <div className=\"space-y-4\">\r\n            {currentContent.sources.map((source) => (\r\n              <label key={source.id} className=\"block cursor-pointer group\">\r\n                <input \r\n                  className=\"hidden\" \r\n                  name=\"source\" \r\n                  type=\"radio\" \r\n                  checked={selectedSource === source.id}\r\n                  onChange={() => setSelectedSource(source.id)}\r\n                />\r\n                <div className={`flex items-center p-5 rounded-xl border-2 transition-all duration-200 shadow-sm ${\r\n                  selectedSource === source.id \r\n                    ? 'border-green-500 bg-green-500/5 dark:bg-green-400/10' \r\n                    : 'border-slate-100 dark:border-slate-800 bg-white dark:bg-slate-800/50 hover:border-green-500/40'\r\n                }`}>\r\n                  <div className={`w-12 h-12 rounded-lg flex items-center justify-center mr-4 transition-colors ${\r\n                      selectedSource === source.id ? 'bg-green-500 text-white' : 'bg-green-500/10 text-green-600 dark:text-green-400'\r\n                  }`}>\r\n                    <span className=\"material-symbols-rounded text-2xl\">{source.icon}</span>\r\n                  </div>\r\n                  <div className=\"flex-1\">\r\n                    <h3 className=\"font-bold\">{source.title}</h3>\r\n                    <p className=\"text-sm text-slate-500 dark:text-slate-400\">{source.desc}</p>\r\n                  </div>\r\n                  <div className={`w-6 h-6 rounded-full border-2 flex items-center justify-center transition-colors ${\r\n                    selectedSource === source.id ? 'border-green-500 bg-green-500' : 'border-slate-200 dark:border-slate-600'\r\n                  }`}>\r\n                    {selectedSource === source.id && <div className=\"w-2 h-2 bg-white rounded-full\"></div>}\r\n                  </div>\r\n                </div>\r\n              </label>\r\n            ))}\r\n          </div>\r\n        </main>\r\n\r\n        {/* Bottom Action Bar */}\r\n        <div className=\"absolute bottom-0 w-full p-6 pb-10 bg-gradient-to-t from-white via-white dark:from-slate-900 dark:via-slate-900 to-transparent z-20\">\r\n          <button \r\n            onClick={handleNext}\r\n            disabled={!selectedSource}\r\n            className={`w-full font-extrabold text-lg py-5 rounded-2xl shadow-xl transition-all active:scale-95 flex items-center justify-center ${\r\n              selectedSource \r\n                ? 'bg-green-500 hover:bg-green-600 text-white shadow-green-500/30' \r\n                : 'bg-slate-200 dark:bg-slate-800 text-slate-400 cursor-not-allowed shadow-none'\r\n            }`}\r\n          >\r\n            {currentContent.nextBtn}\r\n          </button>\r\n        </div>\r\n        \r\n        {/* iOS Indicator */}\r\n        <div className=\"absolute bottom-2 left-1/2 -translate-x-1/2 w-32 h-1.5 bg-slate-300 dark:bg-slate-700 rounded-full z-50\"></div>\r\n      </div>\r\n    </motion.div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\pc\\.gemini\\antigravity\\scratch\\ai-calorie-app\\src\\pages\\onboarding\\GoalSelection.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":3,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[91,130],"text":""},"desc":"Remove unused variable 'motion'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { motion } from 'framer-motion';\r\nimport { useLanguage } from '../../context/LanguageContext';\r\n\r\nconst pageVariants = {\r\n  initial: { opacity: 0, x: 50 },\r\n  animate: { opacity: 1, x: 0, transition: { duration: 0.4 } },\r\n  exit: { opacity: 0, x: -50, transition: { duration: 0.3 } },\r\n};\r\n\r\nexport default function GoalSelection() {\r\n  const navigate = useNavigate();\r\n  const [selectedGoal, setSelectedGoal] = useState(null);\r\n  const { lang, toggleLanguage } = useLanguage();\r\n\r\n  const content = {\r\n    EN: {\r\n      step: \"Step 3 of 4\",\r\n      title: \"Your Main Goal\",\r\n      description: \"Let's customize your AI nutrition experience to fit your needs.\",\r\n      nextBtn: \"Next Step\",\r\n      goals: [\r\n        { id: 'lose_weight', icon: 'trending_down', title: 'Lose Weight', desc: 'Burn fat and get leaner' },\r\n        { id: 'build_muscle', icon: 'fitness_center', title: 'Build Muscle', desc: 'Gain mass and strength' },\r\n        { id: 'maintain', icon: 'balance', title: 'Maintain Weight', desc: 'Stay healthy and fit' },\r\n        { id: 'eat_healthier', icon: 'local_florist', title: 'Eat Healthier', desc: 'Improve overall nutrition' },\r\n      ]\r\n    },\r\n    FR: {\r\n      step: \"Étape 3 sur 4\",\r\n      title: \"Votre Objectif Principal\",\r\n      description: \"Personnalisons votre expérience nutritionnelle IA selon vos besoins.\",\r\n      nextBtn: \"Étape suivante\",\r\n      goals: [\r\n        { id: 'lose_weight', icon: 'trending_down', title: 'Perdre du poids', desc: 'Brûler des graisses et s\\'affiner' },\r\n        { id: 'build_muscle', icon: 'fitness_center', title: 'Prendre du muscle', desc: 'Gagner en masse et en force' },\r\n        { id: 'maintain', icon: 'balance', title: 'Maintenir son poids', desc: 'Rester en forme et en bonne santé' },\r\n        { id: 'eat_healthier', icon: 'local_florist', title: 'Manger plus sainement', desc: 'Améliorer sa nutrition globale' },\r\n      ]\r\n    },\r\n    ES: {\r\n      step: \"Paso 3 de 4\",\r\n      title: \"Tu Objetivo Principal\",\r\n      description: \"Personalicemos tu experiencia de nutrición con IA según tus necesidades.\",\r\n      nextBtn: \"Siguiente paso\",\r\n      goals: [\r\n        { id: 'lose_weight', icon: 'trending_down', title: 'Perder peso', desc: 'Quemar grasa y adelgazar' },\r\n        { id: 'build_muscle', icon: 'fitness_center', title: 'Ganar músculo', desc: 'Aumentar masa y fuerza' },\r\n        { id: 'maintain', icon: 'balance', title: 'Mantener peso', desc: 'Mantenerse sano y en forma' },\r\n        { id: 'eat_healthier', icon: 'local_florist', title: 'Comer más sano', desc: 'Mejorar la nutrición general' },\r\n      ]\r\n    }\r\n  };\r\n\r\n  const currentContent = content[lang] || content['EN'];\r\n\r\n  const handleNext = () => {\r\n    if (selectedGoal) {\r\n      localStorage.setItem('onboarding_goal', selectedGoal);\r\n    }\r\n    navigate('/onboarding/details');\r\n  };\r\n\r\n  const handleBack = () => {\r\n    navigate(-1);\r\n  };\r\n\r\n  return (\r\n    <motion.div \r\n      className=\"bg-background-light dark:bg-background-dark font-display text-slate-900 dark:text-slate-100 min-h-screen flex justify-center\"\r\n      variants={pageVariants}\r\n      initial=\"initial\"\r\n      animate=\"animate\"\r\n      exit=\"exit\"\r\n    >\r\n      <div className=\"w-full max-w-md bg-white dark:bg-slate-900 min-h-screen shadow-2xl relative overflow-hidden flex flex-col\">\r\n\r\n        {/* Progress Header */}\r\n        <div className=\"px-6 pt-10 pb-2 z-10\">\r\n          <div className=\"flex justify-between items-center mb-3\">\r\n            <button onClick={handleBack} className=\"w-10 h-10 flex items-center justify-start text-slate-900 dark:text-slate-100 active:scale-95 transition-transform\">\r\n              <span className=\"material-symbols-rounded\">arrow_back_ios_new</span>\r\n            </button>\r\n            <span className=\"text-sm font-semibold text-slate-500\">{currentContent.step}</span>\r\n            <button \r\n              onClick={toggleLanguage}\r\n              className=\"h-10 px-3 bg-slate-100 dark:bg-slate-800 rounded-full flex items-center gap-1.5 active:scale-95 transition-transform\"\r\n            >\r\n              <span className=\"material-symbols-rounded text-[18px]\">language</span>\r\n              <span className=\"text-xs font-bold tracking-wider\">{lang}</span>\r\n            </button>\r\n          </div>\r\n          {/* Progress Bar */}\r\n          <div className=\"w-full h-1.5 bg-green-500/10 dark:bg-green-400/10 rounded-full overflow-hidden\">\r\n            <div className=\"h-full bg-green-500 dark:bg-green-400 rounded-full transition-all duration-500\" style={{ width: '75%' }}></div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Main Content */}\r\n        <main className=\"flex-1 overflow-y-auto px-6 pt-8 pb-32 no-scrollbar z-10\">\r\n          <h1 className=\"text-3xl font-extrabold leading-tight mb-3\">\r\n            {currentContent.title}\r\n          </h1>\r\n          <p className=\"text-slate-500 dark:text-slate-400 text-lg leading-relaxed mb-10\">\r\n            {currentContent.description}\r\n          </p>\r\n\r\n          {/* Options List */}\r\n          <div className=\"space-y-4\">\r\n            {currentContent.goals.map((goal) => (\r\n              <label key={goal.id} className=\"block cursor-pointer group\">\r\n                <input \r\n                  className=\"hidden\" \r\n                  name=\"goal\" \r\n                  type=\"radio\" \r\n                  checked={selectedGoal === goal.id}\r\n                  onChange={() => setSelectedGoal(goal.id)}\r\n                />\r\n                <div className={`flex items-center p-5 rounded-xl border-2 transition-all duration-200 shadow-sm ${\r\n                  selectedGoal === goal.id \r\n                    ? 'border-green-500 bg-green-500/5 dark:bg-green-400/10' \r\n                    : 'border-slate-100 dark:border-slate-800 bg-white dark:bg-slate-800/50 hover:border-green-500/40'\r\n                }`}>\r\n                  <div className={`w-12 h-12 rounded-lg flex items-center justify-center mr-4 transition-colors ${\r\n                      selectedGoal === goal.id ? 'bg-green-500 text-white' : 'bg-green-500/10 text-green-600 dark:text-green-400'\r\n                  }`}>\r\n                    <span className=\"material-symbols-rounded text-2xl\">{goal.icon}</span>\r\n                  </div>\r\n                  <div className=\"flex-1\">\r\n                    <h3 className=\"font-bold\">{goal.title}</h3>\r\n                    <p className=\"text-sm text-slate-500 dark:text-slate-400\">{goal.desc}</p>\r\n                  </div>\r\n                  <div className={`w-6 h-6 rounded-full border-2 flex items-center justify-center transition-colors ${\r\n                    selectedGoal === goal.id ? 'border-green-500 bg-green-500' : 'border-slate-200 dark:border-slate-600'\r\n                  }`}>\r\n                    {selectedGoal === goal.id && <div className=\"w-2 h-2 bg-white rounded-full\"></div>}\r\n                  </div>\r\n                </div>\r\n              </label>\r\n            ))}\r\n          </div>\r\n        </main>\r\n\r\n        {/* Bottom Action Bar */}\r\n        <div className=\"absolute bottom-0 w-full p-6 pb-10 bg-gradient-to-t from-white via-white dark:from-slate-900 dark:via-slate-900 to-transparent z-20\">\r\n          <button \r\n            onClick={handleNext}\r\n            disabled={!selectedGoal}\r\n            className={`w-full font-extrabold text-lg py-5 rounded-2xl shadow-xl transition-all active:scale-95 flex items-center justify-center ${\r\n              selectedGoal \r\n                ? 'bg-green-500 hover:bg-green-600 text-white shadow-green-500/30' \r\n                : 'bg-slate-200 dark:bg-slate-800 text-slate-400 cursor-not-allowed shadow-none'\r\n            }`}\r\n          >\r\n            {currentContent.nextBtn}\r\n          </button>\r\n        </div>\r\n        \r\n        {/* iOS Indicator */}\r\n        <div className=\"absolute bottom-2 left-1/2 -translate-x-1/2 w-32 h-1.5 bg-slate-300 dark:bg-slate-700 rounded-full z-50\"></div>\r\n      </div>\r\n    </motion.div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\pc\\.gemini\\antigravity\\scratch\\ai-calorie-app\\src\\pages\\onboarding\\PersonalDetails.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":3,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[102,141],"text":""},"desc":"Remove unused variable 'motion'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { motion } from 'framer-motion';\r\nimport { useLanguage } from '../../context/LanguageContext';\r\nimport { supabase } from '../../lib/supabase';\r\n\r\nconst pageVariants = {\r\n  initial: { opacity: 0, x: 50 },\r\n  animate: { opacity: 1, x: 0, transition: { duration: 0.4 } },\r\n  exit: { opacity: 0, x: -50, transition: { duration: 0.3 } },\r\n};\r\n\r\nexport default function PersonalDetails() {\r\n  const navigate = useNavigate();\r\n  const [weight, setWeight] = useState(70);\r\n  const [height, setHeight] = useState(175);\r\n  const [age, setAge] = useState(30);\r\n  const [gender, setGender] = useState('male');\r\n  const [activity, setActivity] = useState(1.2);\r\n  const [calorieGoal, setCalorieGoal] = useState(2000);\r\n  const { lang, toggleLanguage } = useLanguage();\r\n\r\n  const content = {\r\n    EN: {\r\n      step: \"Step 4 of 4\",\r\n      title: \"Personal Details\",\r\n      description: \"This helps the AI calculate your perfect meal plans and insights.\",\r\n      weightLabel: \"Current Weight\",\r\n      heightLabel: \"Height\",\r\n      ageLabel: \"Age\",\r\n      genderLabel: \"Gender\",\r\n      genderMale: \"Male\",\r\n      genderFemale: \"Female\",\r\n      activityLabel: \"Activity Level\",\r\n      activitySedentary: \"Sedentary (Little exercise)\",\r\n      activityLight: \"Light (1-3 days/week)\",\r\n      activityModerate: \"Moderate (3-5 days/week)\",\r\n      activityActive: \"Active (6-7 days/week)\",\r\n      aiGoalTitle: \"Daily Goal\",\r\n      aiGoalDesc: \"Based on your info, we recommend this daily intake.\",\r\n      modifierLose: \"Includes a 400 kcal deficit for weight loss\",\r\n      modifierBuild: \"Includes a 300 kcal surplus to build muscle\",\r\n      modifierMaintain: \"Maintenance calories (no deficit/surplus)\",\r\n      completeBtn: \"Complete Profile\"\r\n    },\r\n    FR: {\r\n      step: \"Étape 4 sur 4\",\r\n      title: \"Détails Personnels\",\r\n      description: \"Cela aide l'IA à calculer vos plans de repas parfaits.\",\r\n      weightLabel: \"Poids Actuel\",\r\n      heightLabel: \"Taille\",\r\n      ageLabel: \"Âge\",\r\n      genderLabel: \"Genre\",\r\n      genderMale: \"Homme\",\r\n      genderFemale: \"Femme\",\r\n      activityLabel: \"Niveau d'activité\",\r\n      activitySedentary: \"Sédentaire (Peu d'exercice)\",\r\n      activityLight: \"Activité légère (1-3 fois/sem.)\",\r\n      activityModerate: \"Activité modérée (3-5 fois/sem.)\",\r\n      activityActive: \"Actif (6-7 fois/sem.)\",\r\n      aiGoalTitle: \"Objectif Quotidien\",\r\n      aiGoalDesc: \"Sur la base de vos infos, voici l'apport recommandé.\",\r\n      modifierLose: \"Inclut un déficit de 400 kcal pour perdre du poids\",\r\n      modifierBuild: \"Inclut un surplus de 300 kcal pour prendre du muscle\",\r\n      modifierMaintain: \"Calories de maintien (aucun déficit/surplus)\",\r\n      completeBtn: \"Terminer le Profil\"\r\n    },\r\n    ES: {\r\n      step: \"Paso 4 de 4\",\r\n      title: \"Detalles Personales\",\r\n      description: \"Esto ayuda a la IA a calcular tus planes de comidas.\",\r\n      weightLabel: \"Peso Actual\",\r\n      heightLabel: \"Altura\",\r\n      ageLabel: \"Edad\",\r\n      genderLabel: \"Género\",\r\n      genderMale: \"Hombre\",\r\n      genderFemale: \"Mujer\",\r\n      activityLabel: \"Nivel de actividad\",\r\n      activitySedentary: \"Sedentario (Poco ejercicio)\",\r\n      activityLight: \"Ligero (1-3 días/sem.)\",\r\n      activityModerate: \"Moderado (3-5 días/sem.)\",\r\n      activityActive: \"Activo (6-7 días/sem.)\",\r\n      aiGoalTitle: \"Objetivo Diario\",\r\n      aiGoalDesc: \"Basado en tu info, recomendamos este consumo.\",\r\n      modifierLose: \"Incluye un déficit de 400 kcal para perder peso\",\r\n      modifierBuild: \"Incluye un superávit de 300 kcal para ganar músculo\",\r\n      modifierMaintain: \"Calorías de mantenimiento (sin déficit/superávit)\",\r\n      completeBtn: \"Completar Perfil\"\r\n    }\r\n  };\r\n\r\n  const currentContent = content[lang] || content['EN'];\r\n  const [modifierText, setModifierText] = useState(\"\");\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState(null);\r\n\r\n  useEffect(() => {\r\n    let mb = 0;\r\n    if (gender === 'male') {\r\n      mb = (10 * weight) + (6.25 * height) - (5 * age) + 5;\r\n    } else {\r\n      mb = (10 * weight) + (6.25 * height) - (5 * age) - 161;\r\n    }\r\n    \r\n    let tdee = mb * activity;\r\n\r\n    const goal = localStorage.getItem('onboarding_goal');\r\n    if (goal === 'lose_weight') {\r\n      tdee -= 400;\r\n      setModifierText(currentContent.modifierLose);\r\n    } else if (goal === 'build_muscle') {\r\n      tdee += 300;\r\n      setModifierText(currentContent.modifierBuild);\r\n    } else {\r\n      setModifierText(currentContent.modifierMaintain);\r\n    }\r\n    \r\n    if (tdee < 1200) tdee = 1200;\r\n\r\n    setCalorieGoal(Math.round(tdee));\r\n  }, [weight, height, age, gender, activity, currentContent]);\r\n\r\n  const handleFinish = async () => {\r\n    setLoading(true);\r\n    setError(null);\r\n\r\n    try {\r\n      const { data: { session }, error: sessionError } = await supabase.auth.getSession();\r\n      \r\n      if (session && !sessionError) {\r\n        // Prepare the data to update\r\n        const goal = localStorage.getItem('onboarding_goal');\r\n        const source = localStorage.getItem('onboarding_source');\r\n\r\n        const profileUpdate = {\r\n          id: session.user.id,\r\n          email: session.user.email,\r\n          goal: goal,\r\n          discovery_source: source,\r\n          height: height,\r\n          weight: weight,\r\n          age: age,\r\n          gender: gender,\r\n          activity_level: activity,\r\n          calorie_goal: calorieGoal,\r\n          updated_at: new Date().toISOString()\r\n        };\r\n\r\n        // Upsert the profiles table (creates it if the trigger failed)\r\n        const { error: updateError } = await supabase\r\n          .from('profiles')\r\n          .upsert(profileUpdate);\r\n\r\n        if (updateError) {\r\n          console.error(\"Supabase profile update error:\", updateError);\r\n        } else {\r\n          // Also insert an initial weight log\r\n          await supabase.from('weight_logs').insert([{\r\n             user_id: session.user.id,\r\n             weight: weight,\r\n             logged_date: new Date().toISOString().split('T')[0]\r\n          }]);\r\n        }\r\n      }\r\n    } catch (err) {\r\n      console.error('Error verifying session or saving profile:', err);\r\n    } finally {\r\n      // Always mark onboarding as complete and navigate to Premium\r\n      localStorage.setItem('onboarding_completed', 'true');\r\n      localStorage.setItem('user_weight', weight);\r\n      localStorage.setItem('user_calorie_goal', calorieGoal);\r\n      \r\n      navigate('/', { replace: true, state: { fromOnboarding: true } });\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleBack = () => {\r\n    navigate(-1);\r\n  };\r\n\r\n  return (\r\n    <motion.div \r\n      className=\"bg-background-light dark:bg-background-dark font-display text-slate-900 dark:text-slate-100 min-h-screen flex justify-center\"\r\n      variants={pageVariants}\r\n      initial=\"initial\"\r\n      animate=\"animate\"\r\n      exit=\"exit\"\r\n    >\r\n      <div className=\"w-full max-w-md bg-white dark:bg-slate-900 min-h-screen shadow-2xl relative overflow-hidden flex flex-col\">\r\n\r\n        {/* Progress Header */}\r\n        <div className=\"px-6 pt-10 pb-2 z-10\">\r\n          <div className=\"flex justify-between items-center mb-3\">\r\n            <button onClick={handleBack} className=\"w-10 h-10 flex items-center justify-start text-slate-900 dark:text-slate-100 active:scale-95 transition-transform\">\r\n              <span className=\"material-symbols-rounded\">arrow_back_ios_new</span>\r\n            </button>\r\n            <span className=\"text-sm font-semibold text-slate-500\">{currentContent.step}</span>\r\n            <button \r\n              onClick={toggleLanguage}\r\n              className=\"h-10 px-3 bg-slate-100 dark:bg-slate-800 rounded-full flex items-center gap-1.5 active:scale-95 transition-transform\"\r\n            >\r\n              <span className=\"material-symbols-rounded text-[18px]\">language</span>\r\n              <span className=\"text-xs font-bold tracking-wider\">{lang}</span>\r\n            </button>\r\n          </div>\r\n          {/* Progress Bar */}\r\n          <div className=\"w-full h-1.5 bg-green-500/10 dark:bg-green-400/10 rounded-full overflow-hidden\">\r\n            <div className=\"h-full bg-green-500 dark:bg-green-400 rounded-full transition-all duration-500\" style={{ width: '100%' }}></div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Main Content */}\r\n        <main className=\"flex-1 overflow-y-auto px-6 pt-8 pb-32 no-scrollbar z-10\">\r\n          <h1 className=\"text-3xl font-extrabold leading-tight mb-3\">\r\n            {currentContent.title}\r\n          </h1>\r\n          <p className=\"text-slate-500 dark:text-slate-400 text-lg leading-relaxed mb-8\">\r\n            {currentContent.description}\r\n          </p>\r\n\r\n          <div className=\"space-y-6\">\r\n            {/* Gender Input */}\r\n            <div className=\"bg-slate-50 dark:bg-slate-800/50 p-5 rounded-2xl border border-slate-100 dark:border-slate-800\">\r\n              <label className=\"font-bold text-slate-700 dark:text-slate-300 block mb-3\">{currentContent.genderLabel}</label>\r\n              <div className=\"flex gap-3\">\r\n                <button \r\n                  onClick={() => setGender('male')}\r\n                  className={`flex-1 py-3 rounded-xl border-2 font-bold transition-all ${gender === 'male' ? 'border-green-500 bg-green-500/10 text-green-700 dark:text-green-400' : 'border-slate-200 dark:border-slate-700 text-slate-500 hover:border-green-500/50'}`}\r\n                >\r\n                  {currentContent.genderMale}\r\n                </button>\r\n                <button \r\n                  onClick={() => setGender('female')}\r\n                  className={`flex-1 py-3 rounded-xl border-2 font-bold transition-all ${gender === 'female' ? 'border-green-500 bg-green-500/10 text-green-700 dark:text-green-400' : 'border-slate-200 dark:border-slate-700 text-slate-500 hover:border-green-500/50'}`}\r\n                >\r\n                  {currentContent.genderFemale}\r\n                </button>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Age Input */}\r\n            <div className=\"bg-slate-50 dark:bg-slate-800/50 p-5 rounded-2xl border border-slate-100 dark:border-slate-800\">\r\n              <div className=\"flex justify-between items-center mb-4\">\r\n                <label className=\"font-bold text-slate-700 dark:text-slate-300\">{currentContent.ageLabel}</label>\r\n                <div className=\"flex items-center bg-white dark:bg-slate-900 shadow-sm rounded-lg overflow-hidden border border-slate-200 dark:border-slate-700 focus-within:border-green-500 focus-within:ring-2 focus-within:ring-green-500/20 transition-all\">\r\n                  <input \r\n                    type=\"number\" \r\n                    min=\"15\" max=\"100\" \r\n                    value={age}\r\n                    onChange={(e) => setAge(parseInt(e.target.value) || 0)}\r\n                    className=\"w-14 px-2 py-1 font-bold text-green-600 dark:text-green-400 bg-transparent text-center focus:outline-none appearance-none\"\r\n                  />\r\n                </div>\r\n              </div>\r\n              <input \r\n                type=\"range\" \r\n                min=\"15\" max=\"100\" \r\n                value={age} \r\n                onChange={(e) => setAge(parseInt(e.target.value))}\r\n                className=\"w-full h-2 bg-slate-200 dark:bg-slate-700 rounded-lg appearance-none cursor-pointer accent-green-500\"\r\n              />\r\n            </div>\r\n\r\n            {/* Weight Input */}\r\n            <div className=\"bg-slate-50 dark:bg-slate-800/50 p-5 rounded-2xl border border-slate-100 dark:border-slate-800\">\r\n              <div className=\"flex justify-between items-center mb-4\">\r\n                <label className=\"font-bold text-slate-700 dark:text-slate-300\">{currentContent.weightLabel}</label>\r\n                <div className=\"flex items-center bg-white dark:bg-slate-900 shadow-sm rounded-lg overflow-hidden border border-slate-200 dark:border-slate-700 focus-within:border-green-500 focus-within:ring-2 focus-within:ring-green-500/20 transition-all\">\r\n                  <input \r\n                    type=\"number\" \r\n                    min=\"40\" max=\"250\" \r\n                    value={weight}\r\n                    onChange={(e) => setWeight(parseInt(e.target.value) || 0)}\r\n                    className=\"w-16 px-2 py-1 font-bold text-green-600 dark:text-green-400 bg-transparent text-right focus:outline-none appearance-none\"\r\n                  />\r\n                  <span className=\"font-bold text-green-600 dark:text-green-400 pr-2 pb-0.5 text-sm\">kg</span>\r\n                </div>\r\n              </div>\r\n              <input \r\n                type=\"range\" \r\n                min=\"40\" max=\"150\" \r\n                value={weight} \r\n                onChange={(e) => setWeight(parseInt(e.target.value))}\r\n                className=\"w-full h-2 bg-slate-200 dark:bg-slate-700 rounded-lg appearance-none cursor-pointer accent-green-500\"\r\n              />\r\n            </div>\r\n\r\n            {/* Height Input */}\r\n            <div className=\"bg-slate-50 dark:bg-slate-800/50 p-5 rounded-2xl border border-slate-100 dark:border-slate-800\">\r\n              <div className=\"flex justify-between items-center mb-4\">\r\n                <label className=\"font-bold text-slate-700 dark:text-slate-300\">{currentContent.heightLabel}</label>\r\n                <div className=\"flex items-center bg-white dark:bg-slate-900 shadow-sm rounded-lg overflow-hidden border border-slate-200 dark:border-slate-700 focus-within:border-green-500 focus-within:ring-2 focus-within:ring-green-500/20 transition-all\">\r\n                  <input \r\n                    type=\"number\" \r\n                    min=\"100\" max=\"250\" \r\n                    value={height}\r\n                    onChange={(e) => setHeight(parseInt(e.target.value) || 0)}\r\n                    className=\"w-16 px-2 py-1 font-bold text-green-600 dark:text-green-400 bg-transparent text-right focus:outline-none appearance-none\"\r\n                  />\r\n                  <span className=\"font-bold text-green-600 dark:text-green-400 pr-2 pb-0.5 text-sm\">cm</span>\r\n                </div>\r\n              </div>\r\n              <input \r\n                type=\"range\" \r\n                min=\"120\" max=\"220\" \r\n                value={height} \r\n                onChange={(e) => setHeight(parseInt(e.target.value))}\r\n                className=\"w-full h-2 bg-slate-200 dark:bg-slate-700 rounded-lg appearance-none cursor-pointer accent-green-500\"\r\n              />\r\n            </div>\r\n\r\n            {/* Activity Level Select */}\r\n            <div className=\"bg-slate-50 dark:bg-slate-800/50 p-5 rounded-2xl border border-slate-100 dark:border-slate-800\">\r\n              <label className=\"font-bold text-slate-700 dark:text-slate-300 block mb-3\">{currentContent.activityLabel}</label>\r\n              <div className=\"relative\">\r\n                <select \r\n                  value={activity}\r\n                  onChange={(e) => setActivity(parseFloat(e.target.value))}\r\n                  className=\"w-full bg-white dark:bg-slate-900 border-2 border-slate-200 dark:border-slate-700 rounded-xl px-4 py-3 font-semibold text-slate-700 dark:text-slate-300 appearance-none outline-none focus:border-green-500\"\r\n                >\r\n                  <option value={1.2}>{currentContent.activitySedentary}</option>\r\n                  <option value={1.375}>{currentContent.activityLight}</option>\r\n                  <option value={1.55}>{currentContent.activityModerate}</option>\r\n                  <option value={1.725}>{currentContent.activityActive}</option>\r\n                </select>\r\n                <span className=\"material-symbols-rounded absolute right-4 top-1/2 -translate-y-1/2 text-slate-400 pointer-events-none\">expand_more</span>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Daily Calorie Goal Estimator */}\r\n            <div className=\"bg-green-50 dark:bg-green-950/20 p-5 rounded-2xl border border-green-100 dark:border-green-900/30\">\r\n              <div className=\"flex items-center gap-2 mb-2\">\r\n                <span className=\"material-symbols-rounded text-green-600 dark:text-green-400 text-xl\">local_fire_department</span>\r\n                <h3 className=\"font-bold text-green-900 dark:text-green-100\">{currentContent.aiGoalTitle}</h3>\r\n              </div>\r\n              <p className=\"text-sm text-green-700/80 dark:text-green-400/80 mb-4\">{currentContent.aiGoalDesc}</p>\r\n              \r\n              <div className=\"flex justify-center items-end gap-1 mb-2\">\r\n                <input \r\n                  type=\"number\" \r\n                  value={calorieGoal}\r\n                  onChange={(e) => setCalorieGoal(parseInt(e.target.value) || 0)}\r\n                  className=\"bg-transparent text-4xl font-extrabold text-center w-28 text-green-800 dark:text-green-200 border-b-2 border-green-300 dark:border-green-700 focus:outline-none focus:border-green-500 rounded-none p-0\"\r\n                />\r\n                <span className=\"text-green-700 font-bold mb-1\">kcal</span>\r\n              </div>\r\n              \r\n              {modifierText && (\r\n                <p className=\"text-center text-xs font-medium text-green-600/70 dark:text-green-400/70 italic mt-3 text-balance\">\r\n                  {modifierText}\r\n                </p>\r\n              )}\r\n\r\n              {error && (\r\n                <div className=\"bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-400 text-sm p-3 rounded-xl border border-red-100 dark:border-red-900/30 flex items-start gap-2 mt-4\">\r\n                  <span className=\"material-symbols-rounded text-lg shrink-0\">error</span>\r\n                  <p>{error}</p>\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </main>\r\n\r\n        {/* Bottom Action Bar */}\r\n        <div className=\"absolute bottom-0 w-full p-6 pb-10 bg-gradient-to-t from-white via-white dark:from-slate-900 dark:via-slate-900 to-transparent z-20\">\r\n          <button \r\n            onClick={handleFinish}\r\n            disabled={loading}\r\n            className={`w-full font-extrabold text-lg py-5 rounded-2xl shadow-xl transition-all flex items-center justify-center gap-2 ${loading ? 'bg-green-400 text-white/80 cursor-not-allowed' : 'bg-green-500 hover:bg-green-600 text-white shadow-green-500/30 active:scale-95'}`}\r\n          >\r\n            {loading ? (\r\n              <>\r\n                <span className=\"material-symbols-rounded animate-spin\">progress_activity</span>\r\n                <span>Saving Profile...</span>\r\n              </>\r\n            ) : (\r\n              <>\r\n                <span>{currentContent.completeBtn}</span>\r\n                <span className=\"material-symbols-rounded\">check_circle</span>\r\n              </>\r\n            )}\r\n          </button>\r\n        </div>\r\n        \r\n        {/* iOS Indicator */}\r\n        <div className=\"absolute bottom-2 left-1/2 -translate-x-1/2 w-32 h-1.5 bg-slate-300 dark:bg-slate-700 rounded-full z-50\"></div>\r\n      </div>\r\n    </motion.div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]}]
